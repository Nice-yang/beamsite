(this.webpackJsonpbeamfield=this.webpackJsonpbeamfield||[]).push([[20],{1462:function(e,t,n){e.exports=n.p+"static/media/no-model.11c177b1.png"},1463:function(e,t,n){e.exports=n.p+"static/media/bim-bg.8eafd327.png"},1464:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkUAAABKCAYAAAC1tyA9AAAFQUlEQVR4nO3d0Wob2R3H8Z8s2XHWVSiGBOpcddM+QNTbPELeItd9u971Mux1/AB1KQRaKIVSOY1tyZL2YuZIZ8bKLiyxohWfDxwyVsZCvvvyPzOjwbt377LFYMvxttcAAPbRasvxttfWRr2f6wAq66j38yDbQwkA4FurA6i/ltVx//xOFPVDqKxhu+rX+nEEALAP+hFU1qJd9WudCVKJon4MlRA6bs+pVx1H5XcBAL61Ejl1+Nz31jwPAylJVv1J0VE28XPSrifV8XG6kyPTIgBgX9QTohI+8ySzdt2laZhZmn65r34no3SnRMP2tSdJTpM8rdZpNmE0as8VRQDAviiBs8hmKjRLcpvkplqD3vkPts9KFJ2kCaCzJL+5urr6/sOHD2+vr6//sFwuT3bxFwEAfA1HR0ez8Xj8t9evX//l1atXf8/m8p/+NUer4WQyqbfNyoToLMn46urqj+/fv//zzc3N71ar1XD3fwoAwC+3Wq2Gd3d3zz9+/Pin8Xh8dX5+/imb7bX631W5Lqi/dfY0yfjy8vLtYrE4/SZ/BQDAV7JYLE4vLy/fJhmn6Zwn2VwOdJRkUN9BVqLopD35bDqd/n7nnxoA4BFMp9Pv0+yGPU33BrJB0r2DrGyhlWuKvnMNEQBwKJbL5XGS77K5eaxzN309KSpRdJzNtAgA4JDUU6Ly/MX1pCh5+ODGEkYAAIekPHux/raOB9tn/Quuj7/FJwUAeERfehD1evss2f41HwAAh6T/na7rh1DX22eD3nEdTAAAh6D/NWXr4374DHonAgAcmq2981PTIGEEAByaL/aNLTIAgIgiAIAkoggAIIkoAgBIIooAAJKIIgCAJKIIACCJKAIASCKKAACSiCIAgCSiCAAgiSgCAEgiigAAkogiAIAkoggAIIkoAgBIIooAAJKIIgCAJKIIACCJKAIASCKKAACSiCIAgCSiCAAgiSgCAEgiigAAkogiAIAkoggAIIkoAgBIIooAAJKIIgCAJKIIACCJKAIASCKKAACSiCIAgCSiCAAgiSgCAEgiigAAkogiAIAkoggAIMlPR9FqZ58CAGA3vtg3/ShaVQsA4BBt7Z2j3n/Wx8udfTQAgN1YZnv3dCZFJYSWSRbtAgA4JKVxSvOsp0VH6Y6Q6iCa7/xjAgA8rnm6YbTuoHr7rJ4SzZLMhsPh/e4/KwDA19d2zaxdD6ZF/Si6T1NQsyQ35+fn/9z1BwYAeAxt19yk6Zx5mu7pRFF/62yW5DbJ58lk8sNoNLKNBgD8qo1Go/lkMvkhyec0nVNPi1ZJVsPJZDJIE0dlDds1evbs2ezFixf/nk6nv729vT1brVYe9ggA/GoMh8PF8+fP//XmzZu/vnz58h9J/pfkU7bE0SjdKdF9krs0o6XrJMOLi4uri4uL/yQZJzlLcprkJMkonogNAOyXcjlQ2fn6f5qmmSb5b3v8OU3v3KeaFo3aNyhhNE8zJbrJJngW7ZteJ3maJoiO2/PKOYNH+9MAAH5eubW+DHrW10iniaASR5+yua6oc01RP4rKNUWD6o3n7S+XCdFJNltsgwgiAGA/lOukyy335U6z23Z9TtM0ZdvsQRT1y2pQvXEprdt0J0RlSiSKAIB98aXnLpY4uquOO1tnqbbPku5t+fUbzrOJoXIdUVmJKAIA9kM96CmrxE+5BX/bwxuTdLfPku6THUsUDdMUVR1Dg5gSAQD7p/9NHf2vMKtf63wxbH9SlN4bDbLZUuuvRBQBAPul3zP9SOqEULZMivpvVB8v23/rABJDAMA+29Y0215b+xF9I5mFP3xBewAAAABJRU5ErkJggg=="},1469:function(module,exports){!function(_$){var settings={},roots={},caches={},_consts={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_setting={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},_initRoot=function(e){var t=data.getRoot(e);t||(t={},data.setRoot(e,t)),t[e.data.key.children]=[],t.expandTriggerFlag=!1,t.curSelectedList=[],t.noSelection=!0,t.createdNodes=[],t.zId=0,t._ver=(new Date).getTime()},_initCache=function(e){var t=data.getCache(e);t||(t={},data.setCache(e,t)),t.nodes=[],t.doms=[]},_bindEvent=function(e){var t=e.treeObj,n=consts.event;t.bind(n.NODECREATED,(function(t,n,a){tools.apply(e.callback.onNodeCreated,[t,n,a])})),t.bind(n.CLICK,(function(t,n,a,o,i){tools.apply(e.callback.onClick,[n,a,o,i])})),t.bind(n.EXPAND,(function(t,n,a){tools.apply(e.callback.onExpand,[t,n,a])})),t.bind(n.COLLAPSE,(function(t,n,a){tools.apply(e.callback.onCollapse,[t,n,a])})),t.bind(n.ASYNC_SUCCESS,(function(t,n,a,o){tools.apply(e.callback.onAsyncSuccess,[t,n,a,o])})),t.bind(n.ASYNC_ERROR,(function(t,n,a,o,i,r){tools.apply(e.callback.onAsyncError,[t,n,a,o,i,r])})),t.bind(n.REMOVE,(function(t,n,a){tools.apply(e.callback.onRemove,[t,n,a])})),t.bind(n.SELECTED,(function(t,n,a){tools.apply(e.callback.onSelected,[n,a])})),t.bind(n.UNSELECTED,(function(t,n,a){tools.apply(e.callback.onUnSelected,[n,a])}))},_unbindEvent=function(e){var t=e.treeObj,n=consts.event;t.unbind(n.NODECREATED).unbind(n.CLICK).unbind(n.EXPAND).unbind(n.COLLAPSE).unbind(n.ASYNC_SUCCESS).unbind(n.ASYNC_ERROR).unbind(n.REMOVE).unbind(n.SELECTED).unbind(n.UNSELECTED)},_eventProxy=function(e){var t=e.target,n=data.getSetting(e.data.treeId),a="",o=null,i="",r="",s=null,l=null,d=null;if(tools.eqs(e.type,"mousedown")?r="mousedown":tools.eqs(e.type,"mouseup")?r="mouseup":tools.eqs(e.type,"contextmenu")?r="contextmenu":tools.eqs(e.type,"click")?tools.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+consts.id.SWITCH)?(a=tools.getNodeMainDom(t).id,i="switchNode"):(d=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(a=tools.getNodeMainDom(d).id,i="clickNode"):tools.eqs(e.type,"dblclick")&&(r="dblclick",(d=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(a=tools.getNodeMainDom(d).id,i="switchNode")),r.length>0&&0==a.length&&(d=tools.getMDom(n,t,[{tagName:"a",attrName:"treeNode"+consts.id.A}]))&&(a=tools.getNodeMainDom(d).id),a.length>0)switch(o=data.getNodeCache(n,a),i){case"switchNode":o.isParent&&(tools.eqs(e.type,"click")||tools.eqs(e.type,"dblclick")&&tools.apply(n.view.dblClickExpand,[n.treeId,o],n.view.dblClickExpand))?s=handler.onSwitchNode:i="";break;case"clickNode":s=handler.onClickNode}switch(r){case"mousedown":l=handler.onZTreeMousedown;break;case"mouseup":l=handler.onZTreeMouseup;break;case"dblclick":l=handler.onZTreeDblclick;break;case"contextmenu":l=handler.onZTreeContextmenu}return{stop:!1,node:o,nodeEventType:i,nodeEventCallback:s,treeEventType:r,treeEventCallback:l}},_initNode=function(e,t,n,a,o,i,r){if(n){var s=data.getRoot(e),l=e.data.key.children;n.level=t,n.tId=e.treeId+"_"+ ++s.zId,n.parentTId=a?a.tId:null,n.open="string"==typeof n.open?tools.eqs(n.open,"true"):!!n.open,n[l]&&n[l].length>0?(n.isParent=!0,n.zAsync=!0):(n.isParent="string"==typeof n.isParent?tools.eqs(n.isParent,"true"):!!n.isParent,n.open=!(!n.isParent||e.async.enable)&&n.open,n.zAsync=!n.isParent),n.isFirstNode=o,n.isLastNode=i,n.getParentNode=function(){return data.getNodeCache(e,n.parentTId)},n.getPreNode=function(){return data.getPreNode(e,n)},n.getNextNode=function(){return data.getNextNode(e,n)},n.getIndex=function(){return data.getNodeIndex(e,n)},n.getPath=function(){return data.getNodePath(e,n)},n.isAjaxing=!1,data.fixPIdKeyValue(e,n)}},_init={bind:[_bindEvent],unbind:[_unbindEvent],caches:[_initCache],nodes:[_initNode],proxys:[_eventProxy],roots:[_initRoot],beforeA:[],afterA:[],innerBeforeA:[],innerAfterA:[],zTreeTools:[]},data={addNodeCache:function(e,t){data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=t},getNodeCacheId:function(e){return e.substring(e.lastIndexOf("_")+1)},addAfterA:function(e){_init.afterA.push(e)},addBeforeA:function(e){_init.beforeA.push(e)},addInnerAfterA:function(e){_init.innerAfterA.push(e)},addInnerBeforeA:function(e){_init.innerBeforeA.push(e)},addInitBind:function(e){_init.bind.push(e)},addInitUnBind:function(e){_init.unbind.push(e)},addInitCache:function(e){_init.caches.push(e)},addInitNode:function(e){_init.nodes.push(e)},addInitProxy:function(e,t){t?_init.proxys.splice(0,0,e):_init.proxys.push(e)},addInitRoot:function(e){_init.roots.push(e)},addNodesData:function(e,t,n,a){var o,i=e.data.key.children;t[i]?n>=t[i].length&&(n=-1):(t[i]=[],n=-1),t[i].length>0&&0===n?(t[i][0].isFirstNode=!1,view.setNodeLineIcos(e,t[i][0])):t[i].length>0&&n<0&&(t[i][t[i].length-1].isLastNode=!1,view.setNodeLineIcos(e,t[i][t[i].length-1])),t.isParent=!0,n<0?t[i]=t[i].concat(a):(o=[n,0].concat(a),t[i].splice.apply(t[i],o))},addSelectedNode:function(e,t){var n=data.getRoot(e);data.isSelectedNode(e,t)||n.curSelectedList.push(t)},addCreatedNode:function(e,t){(e.callback.onNodeCreated||e.view.addDiyDom)&&data.getRoot(e).createdNodes.push(t)},addZTreeTools:function(e){_init.zTreeTools.push(e)},exSetting:function(e){_$.extend(!0,_setting,e)},fixPIdKeyValue:function(e,t){e.data.simpleData.enable&&(t[e.data.simpleData.pIdKey]=t.parentTId?t.getParentNode()[e.data.simpleData.idKey]:e.data.simpleData.rootPId)},getAfterA:function(e,t,n){for(var a=0,o=_init.afterA.length;a<o;a++)_init.afterA[a].apply(this,arguments)},getBeforeA:function(e,t,n){for(var a=0,o=_init.beforeA.length;a<o;a++)_init.beforeA[a].apply(this,arguments)},getInnerAfterA:function(e,t,n){for(var a=0,o=_init.innerAfterA.length;a<o;a++)_init.innerAfterA[a].apply(this,arguments)},getInnerBeforeA:function(e,t,n){for(var a=0,o=_init.innerBeforeA.length;a<o;a++)_init.innerBeforeA[a].apply(this,arguments)},getCache:function(e){return caches[e.treeId]},getNodeIndex:function(e,t){if(!t)return null;for(var n=e.data.key.children,a=t.parentTId?t.getParentNode():data.getRoot(e),o=0,i=a[n].length-1;o<=i;o++)if(a[n][o]===t)return o;return-1},getNextNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,a=t.parentTId?t.getParentNode():data.getRoot(e),o=0,i=a[n].length-1;o<=i;o++)if(a[n][o]===t)return o==i?null:a[n][o+1];return null},getNodeByParam:function(e,t,n,a){if(!t||!n)return null;for(var o=e.data.key.children,i=0,r=t.length;i<r;i++){if(t[i][n]==a)return t[i];var s=data.getNodeByParam(e,t[i][o],n,a);if(s)return s}return null},getNodeCache:function(e,t){if(!t)return null;var n=caches[e.treeId].nodes[data.getNodeCacheId(t)];return n||null},getNodeName:function(e,t){return""+t[e.data.key.name]},getNodePath:function(e,t){return t?((n=t.parentTId?t.getParentNode().getPath():[])&&n.push(t),n):null;var n},getNodeTitle:function(e,t){return""+t[""===e.data.key.title?e.data.key.name:e.data.key.title]},getNodes:function(e){return data.getRoot(e)[e.data.key.children]},getNodesByParam:function(e,t,n,a){if(!t||!n)return[];for(var o=e.data.key.children,i=[],r=0,s=t.length;r<s;r++)t[r][n]==a&&i.push(t[r]),i=i.concat(data.getNodesByParam(e,t[r][o],n,a));return i},getNodesByParamFuzzy:function(e,t,n,a){if(!t||!n)return[];var o=e.data.key.children,i=[];a=a.toLowerCase();for(var r=0,s=t.length;r<s;r++)"string"==typeof t[r][n]&&t[r][n].toLowerCase().indexOf(a)>-1&&i.push(t[r]),i=i.concat(data.getNodesByParamFuzzy(e,t[r][o],n,a));return i},getNodesByFilter:function(e,t,n,a,o){if(!t)return a?null:[];for(var i=e.data.key.children,r=a?null:[],s=0,l=t.length;s<l;s++){if(tools.apply(n,[t[s],o],!1)){if(a)return t[s];r.push(t[s])}var d=data.getNodesByFilter(e,t[s][i],n,a,o);if(a&&d)return d;r=a?d:r.concat(d)}return r},getPreNode:function(e,t){if(!t)return null;for(var n=e.data.key.children,a=t.parentTId?t.getParentNode():data.getRoot(e),o=0,i=a[n].length;o<i;o++)if(a[n][o]===t)return 0==o?null:a[n][o-1];return null},getRoot:function(e){return e?roots[e.treeId]:null},getRoots:function(){return roots},getSetting:function(e){return settings[e]},getSettings:function(){return settings},getZTreeTools:function(e){var t=this.getRoot(this.getSetting(e));return t?t.treeTools:null},initCache:function(e){for(var t=0,n=_init.caches.length;t<n;t++)_init.caches[t].apply(this,arguments)},initNode:function(e,t,n,a,o,i){for(var r=0,s=_init.nodes.length;r<s;r++)_init.nodes[r].apply(this,arguments)},initRoot:function(e){for(var t=0,n=_init.roots.length;t<n;t++)_init.roots[t].apply(this,arguments)},isSelectedNode:function(e,t){for(var n=data.getRoot(e),a=0,o=n.curSelectedList.length;a<o;a++)if(t===n.curSelectedList[a])return!0;return!1},removeNodeCache:function(e,t){var n=e.data.key.children;if(t[n])for(var a=0,o=t[n].length;a<o;a++)data.removeNodeCache(e,t[n][a]);data.getCache(e).nodes[data.getNodeCacheId(t.tId)]=null},removeSelectedNode:function(e,t){for(var n=data.getRoot(e),a=0,o=n.curSelectedList.length;a<o;a++)t!==n.curSelectedList[a]&&data.getNodeCache(e,n.curSelectedList[a].tId)||(n.curSelectedList.splice(a,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,t]),a--,o--)},setCache:function(e,t){caches[e.treeId]=t},setRoot:function(e,t){roots[e.treeId]=t},setZTreeTools:function(e,t){for(var n=0,a=_init.zTreeTools.length;n<a;n++)_init.zTreeTools[n].apply(this,arguments)},transformToArrayFormat:function(e,t){if(!t)return[];var n=e.data.key.children,a=[];if(tools.isArray(t))for(var o=0,i=t.length;o<i;o++)a.push(t[o]),t[o][n]&&(a=a.concat(data.transformToArrayFormat(e,t[o][n])));else a.push(t),t[n]&&(a=a.concat(data.transformToArrayFormat(e,t[n])));return a},transformTozTreeFormat:function(e,t){var n,a,o=e.data.simpleData.idKey,i=e.data.simpleData.pIdKey,r=e.data.key.children;if(!o||""==o||!t)return[];if(tools.isArray(t)){var s=[],l=[];for(n=0,a=t.length;n<a;n++)l[t[n][o]]=t[n];for(n=0,a=t.length;n<a;n++)l[t[n][i]]&&t[n][o]!=t[n][i]?(l[t[n][i]][r]||(l[t[n][i]][r]=[]),l[t[n][i]][r].push(t[n])):s.push(t[n]);return s}return[t]}},event={bindEvent:function(e){for(var t=0,n=_init.bind.length;t<n;t++)_init.bind[t].apply(this,arguments)},unbindEvent:function(e){for(var t=0,n=_init.unbind.length;t<n;t++)_init.unbind[t].apply(this,arguments)},bindTree:function(e){var t={treeId:e.treeId},n=e.treeObj;e.view.txtSelectedEnable||n.bind("selectstart",handler.onSelectStart).css({"-moz-user-select":"-moz-none"}),n.bind("click",t,event.proxy),n.bind("dblclick",t,event.proxy),n.bind("mouseover",t,event.proxy),n.bind("mouseout",t,event.proxy),n.bind("mousedown",t,event.proxy),n.bind("mouseup",t,event.proxy),n.bind("contextmenu",t,event.proxy)},unbindTree:function(e){e.treeObj.unbind("selectstart",handler.onSelectStart).unbind("click",event.proxy).unbind("dblclick",event.proxy).unbind("mouseover",event.proxy).unbind("mouseout",event.proxy).unbind("mousedown",event.proxy).unbind("mouseup",event.proxy).unbind("contextmenu",event.proxy)},doProxy:function(e){for(var t=[],n=0,a=_init.proxys.length;n<a;n++){var o=_init.proxys[n].apply(this,arguments);if(t.push(o),o.stop)break}return t},proxy:function(e){var t=data.getSetting(e.data.treeId);if(!tools.uCanDo(t,e))return!0;for(var n=event.doProxy(e),a=!0,o=0,i=n.length;o<i;o++){var r=n[o];r.nodeEventCallback&&(!0,a=r.nodeEventCallback.apply(r,[e,r.node])&&a),r.treeEventCallback&&(!0,a=r.treeEventCallback.apply(r,[e,r.node])&&a)}return a}},handler={onSwitchNode:function(e,t){var n=data.getSetting(e.data.treeId);if(t.open){if(0==tools.apply(n.callback.beforeCollapse,[n.treeId,t],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}else{if(0==tools.apply(n.callback.beforeExpand,[n.treeId,t],!0))return!0;data.getRoot(n).expandTriggerFlag=!0,view.switchNode(n,t)}return!0},onClickNode:function(e,t){var n=data.getSetting(e.data.treeId),a=n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&data.isSelectedNode(n,t)?0:n.view.autoCancelSelected&&(e.ctrlKey||e.metaKey)&&n.view.selectedMulti?2:1;return 0==tools.apply(n.callback.beforeClick,[n.treeId,t,a],!0)||(0===a?view.cancelPreSelectedNode(n,t):view.selectNode(n,t,2===a),n.treeObj.trigger(consts.event.CLICK,[e,n.treeId,t,a])),!0},onZTreeMousedown:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseDown,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseDown,[e,n.treeId,t]),!0},onZTreeMouseup:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeMouseUp,[n.treeId,t],!0)&&tools.apply(n.callback.onMouseUp,[e,n.treeId,t]),!0},onZTreeDblclick:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeDblClick,[n.treeId,t],!0)&&tools.apply(n.callback.onDblClick,[e,n.treeId,t]),!0},onZTreeContextmenu:function(e,t){var n=data.getSetting(e.data.treeId);return tools.apply(n.callback.beforeRightClick,[n.treeId,t],!0)&&tools.apply(n.callback.onRightClick,[e,n.treeId,t]),"function"!=typeof n.callback.onRightClick},onSelectStart:function(e){var t=e.originalEvent.srcElement.nodeName.toLowerCase();return"input"===t||"textarea"===t}},tools={apply:function(e,t,n){return"function"==typeof e?e.apply(zt,t||[]):n},canAsync:function(e,t){var n=e.data.key.children;return e.async.enable&&t&&t.isParent&&!(t.zAsync||t[n]&&t[n].length>0)},clone:function(e){if(null===e)return null;var t=tools.isArray(e)?[]:{};for(var n in e)t[n]=e[n]instanceof Date?new Date(e[n].getTime()):"object"===typeof e[n]?tools.clone(e[n]):e[n];return t},eqs:function(e,t){return e.toLowerCase()===t.toLowerCase()},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},$:function(e,t,n){return t&&"string"!=typeof t&&(n=t,t=""),"string"==typeof e?_$(e,n?n.treeObj.get(0).ownerDocument:null):_$("#"+e.tId+t,n?n.treeObj:null)},getMDom:function(e,t,n){if(!t)return null;for(;t&&t.id!==e.treeId;){for(var a=0,o=n.length;t.tagName&&a<o;a++)if(tools.eqs(t.tagName,n[a].tagName)&&null!==t.getAttribute(n[a].attrName))return t;t=t.parentNode}return null},getNodeMainDom:function(e){return _$(e).parent("li").get(0)||_$(e).parentsUntil("li").parent().get(0)},isChildOrSelf:function(e,t){return _$(e).closest("#"+t).length>0},uCanDo:function(e,t){return!0}},view={addNodes:function(e,t,n,a,o){if(!e.data.keep.leaf||!t||t.isParent)if(tools.isArray(a)||(a=[a]),e.data.simpleData.enable&&(a=data.transformTozTreeFormat(e,a)),t){var i=$$(t,consts.id.SWITCH,e),r=$$(t,consts.id.ICON,e),s=$$(t,consts.id.UL,e);t.open||(view.replaceSwitchClass(t,i,consts.folder.CLOSE),view.replaceIcoClass(t,r,consts.folder.CLOSE),t.open=!1,s.css({display:"none"})),data.addNodesData(e,t,n,a),view.createNodes(e,t.level+1,a,t,n),o||view.expandCollapseParentNode(e,t,!0)}else data.addNodesData(e,data.getRoot(e),n,a),view.createNodes(e,0,a,null,n)},appendNodes:function(e,t,n,a,o,i,r){if(!n)return[];var s,l,d=[],c=e.data.key.children,p=(a||data.getRoot(e))[c];(!p||o>=p.length)&&(o=-1);for(var u=0,h=n.length;u<h;u++){var m=n[u];i&&(s=(0===o||p.length==n.length)&&0==u,l=o<0&&u==n.length-1,data.initNode(e,t,m,a,s,l,r),data.addNodeCache(e,m));var g=[];m[c]&&m[c].length>0&&(g=view.appendNodes(e,t+1,m[c],m,-1,i,r&&m.open)),r&&(view.makeDOMNodeMainBefore(d,e,m),view.makeDOMNodeLine(d,e,m),data.getBeforeA(e,m,d),view.makeDOMNodeNameBefore(d,e,m),data.getInnerBeforeA(e,m,d),view.makeDOMNodeIcon(d,e,m),data.getInnerAfterA(e,m,d),view.makeDOMNodeNameAfter(d,e,m),data.getAfterA(e,m,d),m.isParent&&m.open&&view.makeUlHtml(e,m,d,g.join("")),view.makeDOMNodeMainAfter(d,e,m),data.addCreatedNode(e,m))}return d},appendParentULDom:function(e,t){var n=[],a=$$(t,e);!a.get(0)&&t.parentTId&&(view.appendParentULDom(e,t.getParentNode()),a=$$(t,e));var o=$$(t,consts.id.UL,e);o.get(0)&&o.remove();var i=e.data.key.children,r=view.appendNodes(e,t.level+1,t[i],t,-1,!1,!0);view.makeUlHtml(e,t,n,r.join("")),a.append(n.join(""))},asyncNode:function asyncNode(setting,node,isSilent,callback){var i,l;if(node&&!node.isParent)return tools.apply(callback),!1;if(node&&node.isAjaxing)return!1;if(0==tools.apply(setting.callback.beforeAsync,[setting.treeId,node],!0))return tools.apply(callback),!1;if(node){node.isAjaxing=!0;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"",class:consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={};for(i=0,l=setting.async.autoParam.length;node&&i<l;i++){var pKey=setting.async.autoParam[i].split("="),spKey=pKey;pKey.length>1&&(spKey=pKey[1],pKey=pKey[0]),tmpParam[spKey]=node[pKey]}if(tools.isArray(setting.async.otherParam))for(i=0,l=setting.async.otherParam.length;i<l;i+=2)tmpParam[setting.async.otherParam[i]]=setting.async.otherParam[i+1];else for(var p in setting.async.otherParam)tmpParam[p]=setting.async.otherParam[p];var _tmpV=data.getRoot(setting)._ver;return _$.ajax({contentType:setting.async.contentType,cache:!1,type:setting.async.type,url:tools.apply(setting.async.url,[setting.treeId,node],setting.async.url),data:tmpParam,dataType:setting.async.dataType,success:function success(msg){if(_tmpV==data.getRoot(setting)._ver){var newNodes=[];try{newNodes=msg&&0!=msg.length?"string"==typeof msg?eval("("+msg+")"):msg:[]}catch(err){newNodes=msg}node&&(node.isAjaxing=null,node.zAsync=!0),view.setNodeLineIcos(setting,node),newNodes&&""!==newNodes?(newNodes=tools.apply(setting.async.dataFilter,[setting.treeId,node,newNodes],newNodes),view.addNodes(setting,node,-1,newNodes?tools.clone(newNodes):[],!!isSilent)):view.addNodes(setting,node,-1,[],!!isSilent),setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg]),tools.apply(callback)}},error:function(e,t,n){_tmpV==data.getRoot(setting)._ver&&(node&&(node.isAjaxing=null),view.setNodeLineIcos(setting,node),setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,e,t,n]))}}),!0},cancelPreSelectedNode:function(e,t,n){var a,o,i=data.getRoot(e).curSelectedList;for(a=i.length-1;a>=0;a--)if(t===(o=i[a])||!t&&(!n||n!==o)){if($$(o,consts.id.A,e).removeClass(consts.node.CURSELECTED),t){data.removeSelectedNode(e,t);break}i.splice(a,1),e.treeObj.trigger(consts.event.UNSELECTED,[e.treeId,o])}},createNodeCallback:function(e){if(e.callback.onNodeCreated||e.view.addDiyDom)for(var t=data.getRoot(e);t.createdNodes.length>0;){var n=t.createdNodes.shift();tools.apply(e.view.addDiyDom,[e.treeId,n]),e.callback.onNodeCreated&&e.treeObj.trigger(consts.event.NODECREATED,[e.treeId,n])}},createNodes:function(e,t,n,a,o){if(n&&0!=n.length){var i=data.getRoot(e),r=e.data.key.children,s=!a||a.open||!!$$(a[r][0],e).get(0);i.createdNodes=[];var l,d,c=view.appendNodes(e,t,n,a,o,!0,s);if(a){var p=$$(a,consts.id.UL,e);p.get(0)&&(l=p)}else l=e.treeObj;l&&(o>=0&&(d=l.children()[o]),o>=0&&d?_$(d).before(c.join("")):l.append(c.join(""))),view.createNodeCallback(e)}},destroy:function(e){e&&(data.initCache(e),data.initRoot(e),event.unbindTree(e),event.unbindEvent(e),e.treeObj.empty(),delete settings[e.treeId])},expandCollapseNode:function(e,t,n,a,o){var i,r=data.getRoot(e),s=e.data.key.children;if(t)if(r.expandTriggerFlag&&(i=o,o=function(){i&&i(),t.open?e.treeObj.trigger(consts.event.EXPAND,[e.treeId,t]):e.treeObj.trigger(consts.event.COLLAPSE,[e.treeId,t])},r.expandTriggerFlag=!1),!t.open&&t.isParent&&(!$$(t,consts.id.UL,e).get(0)||t[s]&&t[s].length>0&&!$$(t[s][0],e).get(0))&&(view.appendParentULDom(e,t),view.createNodeCallback(e)),t.open!=n){var l=$$(t,consts.id.UL,e),d=$$(t,consts.id.SWITCH,e),c=$$(t,consts.id.ICON,e);t.isParent?(t.open=!t.open,t.iconOpen&&t.iconClose&&c.attr("style",view.makeNodeIcoStyle(e,t)),t.open?(view.replaceSwitchClass(t,d,consts.folder.OPEN),view.replaceIcoClass(t,c,consts.folder.OPEN),0==a||""==e.view.expandSpeed?(l.show(),tools.apply(o,[])):t[s]&&t[s].length>0?l.slideDown(e.view.expandSpeed,o):(l.show(),tools.apply(o,[]))):(view.replaceSwitchClass(t,d,consts.folder.CLOSE),view.replaceIcoClass(t,c,consts.folder.CLOSE),0!=a&&""!=e.view.expandSpeed&&t[s]&&t[s].length>0?l.slideUp(e.view.expandSpeed,o):(l.hide(),tools.apply(o,[])))):tools.apply(o,[])}else tools.apply(o,[]);else tools.apply(o,[])},expandCollapseParentNode:function(e,t,n,a,o){t&&(t.parentTId?(view.expandCollapseNode(e,t,n,a),t.parentTId&&view.expandCollapseParentNode(e,t.getParentNode(),n,a,o)):view.expandCollapseNode(e,t,n,a,o))},expandCollapseSonNode:function(e,t,n,a,o){var i=data.getRoot(e),r=e.data.key.children,s=t?t[r]:i[r],l=!t&&a,d=data.getRoot(e).expandTriggerFlag;if(data.getRoot(e).expandTriggerFlag=!1,s)for(var c=0,p=s.length;c<p;c++)s[c]&&view.expandCollapseSonNode(e,s[c],n,l);data.getRoot(e).expandTriggerFlag=d,view.expandCollapseNode(e,t,n,a,o)},isSelectedNode:function(e,t){if(!t)return!1;var n,a=data.getRoot(e).curSelectedList;for(n=a.length-1;n>=0;n--)if(t===a[n])return!0;return!1},makeDOMNodeIcon:function(e,t,n){var a=data.getNodeName(t,n),o=t.view.nameIsHTML?a:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e.push("<span id='",n.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",view.makeNodeIcoClass(t,n),"' style='",view.makeNodeIcoStyle(t,n),"'></span><span id='",n.tId,consts.id.SPAN,"' class='",consts.className.NAME,"'>",o,"</span>")},makeDOMNodeLine:function(e,t,n){e.push("<span id='",n.tId,consts.id.SWITCH,"' title='' class='",view.makeNodeLineClass(t,n),"' treeNode",consts.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(e,t,n){e.push("</li>")},makeDOMNodeMainBefore:function(e,t,n){e.push("<li id='",n.tId,"' class='",consts.className.LEVEL,n.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(e,t,n){e.push("</a>")},makeDOMNodeNameBefore:function(e,t,n){var a=data.getNodeTitle(t,n),o=view.makeNodeUrl(t,n),i=view.makeNodeFontCss(t,n),r=[];for(var s in i)r.push(s,":",i[s],";");e.push("<a id='",n.tId,consts.id.A,"' class='",consts.className.LEVEL,n.level,"' treeNode",consts.id.A,' onclick="',n.click||"",'" ',null!=o&&o.length>0?"href='"+o+"'":""," target='",view.makeNodeTarget(n),"' style='",r.join(""),"'"),tools.apply(t.view.showTitle,[t.treeId,n],t.view.showTitle)&&a&&e.push("title='",a.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),e.push(">")},makeNodeFontCss:function(e,t){var n=tools.apply(e.view.fontCss,[e.treeId,t],e.view.fontCss);return n&&"function"!=typeof n?n:{}},makeNodeIcoClass:function(e,t){var n=["ico"];return t.isAjaxing||(n[0]=(t.iconSkin?t.iconSkin+"_":"")+n[0],t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU)),consts.className.BUTTON+" "+n.join("_")},makeNodeIcoStyle:function(e,t){var n=[];if(!t.isAjaxing){var a=t.isParent&&t.iconOpen&&t.iconClose?t.open?t.iconOpen:t.iconClose:t[e.data.key.icon];a&&n.push("background:url(",a,") 0 0 no-repeat;"),0!=e.view.showIcon&&tools.apply(e.view.showIcon,[e.treeId,t],!0)||n.push("width:0px;height:0px;")}return n.join("")},makeNodeLineClass:function(e,t){var n=[];return e.view.showLine?0==t.level&&t.isFirstNode&&t.isLastNode?n.push(consts.line.ROOT):0==t.level&&t.isFirstNode?n.push(consts.line.ROOTS):t.isLastNode?n.push(consts.line.BOTTOM):n.push(consts.line.CENTER):n.push(consts.line.NOLINE),t.isParent?n.push(t.open?consts.folder.OPEN:consts.folder.CLOSE):n.push(consts.folder.DOCU),view.makeNodeLineClassEx(t)+n.join("_")},makeNodeLineClassEx:function(e){return consts.className.BUTTON+" "+consts.className.LEVEL+e.level+" "+consts.className.SWITCH+" "},makeNodeTarget:function(e){return e.target||"_blank"},makeNodeUrl:function(e,t){var n=e.data.key.url;return t[n]?t[n]:null},makeUlHtml:function(e,t,n,a){n.push("<ul id='",t.tId,consts.id.UL,"' class='",consts.className.LEVEL,t.level," ",view.makeUlLineClass(e,t),"' style='display:",t.open?"block":"none","'>"),n.push(a),n.push("</ul>")},makeUlLineClass:function(e,t){return e.view.showLine&&!t.isLastNode?consts.line.LINE:""},removeChildNodes:function(e,t){if(t){var n=e.data.key.children,a=t[n];if(a){for(var o=0,i=a.length;o<i;o++)data.removeNodeCache(e,a[o]);if(data.removeSelectedNode(e),delete t[n],e.data.keep.parent)$$(t,consts.id.UL,e).empty();else{t.isParent=!1,t.open=!1;var r=$$(t,consts.id.SWITCH,e),s=$$(t,consts.id.ICON,e);view.replaceSwitchClass(t,r,consts.folder.DOCU),view.replaceIcoClass(t,s,consts.folder.DOCU),$$(t,consts.id.UL,e).remove()}}}},scrollIntoView:function(e){if(e)if(e.scrollIntoViewIfNeeded)e.scrollIntoViewIfNeeded();else if(e.scrollIntoView)e.scrollIntoView(!1);else try{e.focus().blur()}catch(t){}},setFirstNode:function(e,t){var n=e.data.key.children;t[n].length>0&&(t[n][0].isFirstNode=!0)},setLastNode:function(e,t){var n=e.data.key.children,a=t[n].length;a>0&&(t[n][a-1].isLastNode=!0)},removeNode:function(e,t){var n=data.getRoot(e),a=e.data.key.children,o=t.parentTId?t.getParentNode():n;if(t.isFirstNode=!1,t.isLastNode=!1,t.getPreNode=function(){return null},t.getNextNode=function(){return null},data.getNodeCache(e,t.tId)){$$(t,e).remove(),data.removeNodeCache(e,t),data.removeSelectedNode(e,t);for(var i=0,r=o[a].length;i<r;i++)if(o[a][i].tId==t.tId){o[a].splice(i,1);break}view.setFirstNode(e,o),view.setLastNode(e,o);var s,l,d,c=o[a].length;if(e.data.keep.parent||0!=c){if(e.view.showLine&&c>0){var p=o[a][c-1];if(s=$$(p,consts.id.UL,e),l=$$(p,consts.id.SWITCH,e),d=$$(p,consts.id.ICON,e),o==n)if(1==o[a].length)view.replaceSwitchClass(p,l,consts.line.ROOT);else{var u=$$(o[a][0],consts.id.SWITCH,e);view.replaceSwitchClass(o[a][0],u,consts.line.ROOTS),view.replaceSwitchClass(p,l,consts.line.BOTTOM)}else view.replaceSwitchClass(p,l,consts.line.BOTTOM);s.removeClass(consts.line.LINE)}}else o.isParent=!1,o.open=!1,s=$$(o,consts.id.UL,e),l=$$(o,consts.id.SWITCH,e),d=$$(o,consts.id.ICON,e),view.replaceSwitchClass(o,l,consts.folder.DOCU),view.replaceIcoClass(o,d,consts.folder.DOCU),s.css("display","none")}},replaceIcoClass:function(e,t,n){if(t&&!e.isAjaxing){var a=t.attr("class");if(void 0!=a){var o=a.split("_");switch(n){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:o[o.length-1]=n}t.attr("class",o.join("_"))}}},replaceSwitchClass:function(e,t,n){if(t){var a=t.attr("class");if(void 0!=a){var o=a.split("_");switch(n){case consts.line.ROOT:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.NOLINE:o[0]=view.makeNodeLineClassEx(e)+n;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.DOCU:o[1]=n}t.attr("class",o.join("_")),n!==consts.folder.DOCU?t.removeAttr("disabled"):t.attr("disabled","disabled")}}},selectNode:function(e,t,n){n||view.cancelPreSelectedNode(e,null,t),$$(t,consts.id.A,e).addClass(consts.node.CURSELECTED),data.addSelectedNode(e,t),e.treeObj.trigger(consts.event.SELECTED,[e.treeId,t])},setNodeFontCss:function(e,t){var n=$$(t,consts.id.A,e),a=view.makeNodeFontCss(e,t);a&&n.css(a)},setNodeLineIcos:function(e,t){if(t){var n=$$(t,consts.id.SWITCH,e),a=$$(t,consts.id.UL,e),o=$$(t,consts.id.ICON,e),i=view.makeUlLineClass(e,t);0==i.length?a.removeClass(consts.line.LINE):a.addClass(i),n.attr("class",view.makeNodeLineClass(e,t)),t.isParent?n.removeAttr("disabled"):n.attr("disabled","disabled"),o.removeAttr("style"),o.attr("style",view.makeNodeIcoStyle(e,t)),o.attr("class",view.makeNodeIcoClass(e,t))}},setNodeName:function(e,t){var n=data.getNodeTitle(e,t),a=$$(t,consts.id.SPAN,e);(a.empty(),e.view.nameIsHTML?a.html(data.getNodeName(e,t)):a.text(data.getNodeName(e,t)),tools.apply(e.view.showTitle,[e.treeId,t],e.view.showTitle))&&$$(t,consts.id.A,e).attr("title",n||"")},setNodeTarget:function(e,t){$$(t,consts.id.A,e).attr("target",view.makeNodeTarget(t))},setNodeUrl:function(e,t){var n=$$(t,consts.id.A,e),a=view.makeNodeUrl(e,t);null==a||0==a.length?n.removeAttr("href"):n.attr("href",a)},switchNode:function(e,t){if(t.open||!tools.canAsync(e,t))view.expandCollapseNode(e,t,!t.open);else if(e.async.enable){if(!view.asyncNode(e,t))return void view.expandCollapseNode(e,t,!t.open)}else t&&view.expandCollapseNode(e,t,!t.open)}};_$.fn.zTree={consts:_consts,_z:{tools:tools,view:view,event:event,data:data},getZTreeObj:function(e){var t=data.getZTreeTools(e);return t||null},destroy:function(e){if(e&&e.length>0)view.destroy(data.getSetting(e));else for(var t in settings)view.destroy(settings[t])},init:function(e,t,n){var a=tools.clone(_setting);_$.extend(!0,a,t),a.treeId=e.attr("id"),a.treeObj=e,a.treeObj.empty(),settings[a.treeId]=a,"undefined"===typeof document.body.style.maxHeight&&(a.view.expandSpeed=""),data.initRoot(a);var o=data.getRoot(a),i=a.data.key.children;n=n?tools.clone(tools.isArray(n)?n:[n]):[],a.data.simpleData.enable?o[i]=data.transformTozTreeFormat(a,n):o[i]=n,data.initCache(a),event.unbindTree(a),event.bindTree(a),event.unbindEvent(a),event.bindEvent(a);var r={setting:a,addNodes:function(e,t,n,o){if(e||(e=null),e&&!e.isParent&&a.data.keep.leaf)return null;var i=parseInt(t,10);if(isNaN(i)?(o=!!n,n=t,t=-1):t=i,!n)return null;var r=tools.clone(tools.isArray(n)?n:[n]);function s(){view.addNodes(a,e,t,r,1==o)}return tools.canAsync(a,e)?view.asyncNode(a,e,o,s):s(),r},cancelSelectedNode:function(e){view.cancelPreSelectedNode(a,e)},destroy:function(){view.destroy(a)},expandAll:function(e){return e=!!e,view.expandCollapseSonNode(a,null,e,!0),e},expandNode:function(e,t,n,o,i){return e&&e.isParent?(!0!==t&&!1!==t&&(t=!e.open),(i=!!i)&&t&&0==tools.apply(a.callback.beforeExpand,[a.treeId,e],!0)||i&&!t&&0==tools.apply(a.callback.beforeCollapse,[a.treeId,e],!0)?null:(t&&e.parentTId&&view.expandCollapseParentNode(a,e.getParentNode(),t,!1),t!==e.open||n?(data.getRoot(a).expandTriggerFlag=i,!tools.canAsync(a,e)&&n?view.expandCollapseSonNode(a,e,t,!0,r):(e.open=!t,view.switchNode(this.setting,e),r()),t):null)):null;function r(){var t=$$(e,a).get(0);t&&!1!==o&&view.scrollIntoView(t)}},getNodes:function(){return data.getNodes(a)},getNodeByParam:function(e,t,n){return e?data.getNodeByParam(a,n?n[a.data.key.children]:data.getNodes(a),e,t):null},getNodeByTId:function(e){return data.getNodeCache(a,e)},getNodesByParam:function(e,t,n){return e?data.getNodesByParam(a,n?n[a.data.key.children]:data.getNodes(a),e,t):null},getNodesByParamFuzzy:function(e,t,n){return e?data.getNodesByParamFuzzy(a,n?n[a.data.key.children]:data.getNodes(a),e,t):null},getNodesByFilter:function(e,t,n,o){return t=!!t,e&&"function"==typeof e?data.getNodesByFilter(a,n?n[a.data.key.children]:data.getNodes(a),e,t,o):t?null:[]},getNodeIndex:function(e){if(!e)return null;for(var t=a.data.key.children,n=e.parentTId?e.getParentNode():data.getRoot(a),o=0,i=n[t].length;o<i;o++)if(n[t][o]==e)return o;return-1},getSelectedNodes:function(){for(var e=[],t=data.getRoot(a).curSelectedList,n=0,o=t.length;n<o;n++)e.push(t[n]);return e},isSelectedNode:function(e){return data.isSelectedNode(a,e)},reAsyncChildNodes:function(e,t,n){if(this.setting.async.enable){var o=!e;if(o&&(e=data.getRoot(a)),"refresh"==t){for(var i=this.setting.data.key.children,r=0,s=e[i]?e[i].length:0;r<s;r++)data.removeNodeCache(a,e[i][r]);if(data.removeSelectedNode(a),e[i]=[],o)this.setting.treeObj.empty();else $$(e,consts.id.UL,a).empty()}view.asyncNode(this.setting,o?null:e,!!n)}},refresh:function(){this.setting.treeObj.empty();var e=data.getRoot(a),t=e[a.data.key.children];data.initRoot(a),e[a.data.key.children]=t,data.initCache(a),view.createNodes(a,0,e[a.data.key.children],null,-1)},removeChildNodes:function(e){if(!e)return null;var t=e[a.data.key.children];return view.removeChildNodes(a,e),t||null},removeNode:function(e,t){e&&((t=!!t)&&0==tools.apply(a.callback.beforeRemove,[a.treeId,e],!0)||(view.removeNode(a,e),t&&this.setting.treeObj.trigger(consts.event.REMOVE,[a.treeId,e])))},selectNode:function(e,t,n){if(e&&tools.uCanDo(a)){if(t=a.view.selectedMulti&&t,e.parentTId)view.expandCollapseParentNode(a,e.getParentNode(),!0,!1,(function(){if(n)return;var t=$$(e,a).get(0);view.scrollIntoView(t)}));else try{$$(e,a).focus().blur()}catch(o){}view.selectNode(a,e,t)}},transformTozTreeNodes:function(e){return data.transformTozTreeFormat(a,e)},transformToArray:function(e){return data.transformToArrayFormat(a,e)},updateNode:function(e,t){e&&($$(e,a).get(0)&&tools.uCanDo(a)&&(view.setNodeName(a,e),view.setNodeTarget(a,e),view.setNodeUrl(a,e),view.setNodeLineIcos(a,e),view.setNodeFontCss(a,e)))}};return o.treeTools=r,data.setZTreeTools(a,r),o[i]&&o[i].length>0?view.createNodes(a,0,o[i],null,-1):a.async.enable&&a.async.url&&""!==a.async.url&&view.asyncNode(a),r}};var zt=_$.fn.zTree,$$=tools.$,consts=zt.consts}(jQuery),function(e){var t={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:!1,autoCheckTrigger:!1,chkStyle:t.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:t.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},a={onCheckNode:function(e,t){if(!0===t.chkDisabled)return!1;var n=d.getSetting(e.data.treeId),a=n.data.key.checked;if(0==r.apply(n.callback.beforeCheck,[n.treeId,t],!0))return!0;t[a]=!t[a],l.checkNodeRelation(n,t);var o=c(t,s.id.CHECK,n);return l.setChkClass(n,o,t),l.repairParentChkClassWithSelf(n,t),n.treeObj.trigger(s.event.CHECK,[e,n.treeId,t]),!0},onMouseoverCheck:function(e,t){if(!0===t.chkDisabled)return!1;var n=d.getSetting(e.data.treeId),a=c(t,s.id.CHECK,n);return t.check_Focus=!0,l.setChkClass(n,a,t),!0},onMouseoutCheck:function(e,t){if(!0===t.chkDisabled)return!1;var n=d.getSetting(e.data.treeId),a=c(t,s.id.CHECK,n);return t.check_Focus=!1,l.setChkClass(n,a,t),!0}},o={tools:{},view:{checkNodeRelation:function(e,t){var n,a,o,i=e.data.key.children,r=e.data.key.checked,p=s.radio;if(e.check.chkStyle==p.STYLE){var u=d.getRadioCheckedList(e);if(t[r])if(e.check.radioType==p.TYPE_ALL){for(a=u.length-1;a>=0;a--)(n=u[a])[r]&&n!=t&&(n[r]=!1,u.splice(a,1),l.setChkClass(e,c(n,s.id.CHECK,e),n),n.parentTId!=t.parentTId&&l.repairParentChkClassWithSelf(e,n));u.push(t)}else{var h=t.parentTId?t.getParentNode():d.getRoot(e);for(a=0,o=h[i].length;a<o;a++)(n=h[i][a])[r]&&n!=t&&(n[r]=!1,l.setChkClass(e,c(n,s.id.CHECK,e),n))}else if(e.check.radioType==p.TYPE_ALL)for(a=0,o=u.length;a<o;a++)if(t==u[a]){u.splice(a,1);break}}else t[r]&&(!t[i]||0==t[i].length||e.check.chkboxType.Y.indexOf("s")>-1)&&l.setSonNodeCheckBox(e,t,!0),t[r]||t[i]&&0!=t[i].length&&!(e.check.chkboxType.N.indexOf("s")>-1)||l.setSonNodeCheckBox(e,t,!1),t[r]&&e.check.chkboxType.Y.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!0),!t[r]&&e.check.chkboxType.N.indexOf("p")>-1&&l.setParentNodeCheckBox(e,t,!1)},makeChkClass:function(e,t){var n=e.data.key.checked,a=s.checkbox,o=s.radio,i="";i=!0===t.chkDisabled?a.DISABLED:t.halfCheck?a.PART:e.check.chkStyle==o.STYLE?t.check_Child_State<1?a.FULL:a.PART:t[n]?2===t.check_Child_State||-1===t.check_Child_State?a.FULL:a.PART:t.check_Child_State<1?a.FULL:a.PART;var r=e.check.chkStyle+"_"+(t[n]?a.TRUE:a.FALSE)+"_"+i;return r=t.check_Focus&&!0!==t.chkDisabled?r+"_"+a.FOCUS:r,s.className.BUTTON+" "+a.DEFAULT+" "+r},repairAllChk:function(e,t){if(e.check.enable&&e.check.chkStyle===s.checkbox.STYLE)for(var n=e.data.key.checked,a=e.data.key.children,o=d.getRoot(e),i=0,r=o[a].length;i<r;i++){var c=o[a][i];!0!==c.nocheck&&!0!==c.chkDisabled&&(c[n]=t),l.setSonNodeCheckBox(e,c,t)}},repairChkClass:function(e,t){if(t&&(d.makeChkFlag(e,t),!0!==t.nocheck)){var n=c(t,s.id.CHECK,e);l.setChkClass(e,n,t)}},repairParentChkClass:function(e,t){if(t&&t.parentTId){var n=t.getParentNode();l.repairChkClass(e,n),l.repairParentChkClass(e,n)}},repairParentChkClassWithSelf:function(e,t){if(t){var n=e.data.key.children;t[n]&&t[n].length>0?l.repairParentChkClass(e,t[n][0]):l.repairParentChkClass(e,t)}},repairSonChkDisabled:function(e,t,n,a){if(t){var o=e.data.key.children;if(t.chkDisabled!=n&&(t.chkDisabled=n),l.repairChkClass(e,t),t[o]&&a)for(var i=0,r=t[o].length;i<r;i++){var s=t[o][i];l.repairSonChkDisabled(e,s,n,a)}}},repairParentChkDisabled:function(e,t,n,a){t&&(t.chkDisabled!=n&&a&&(t.chkDisabled=n),l.repairChkClass(e,t),l.repairParentChkDisabled(e,t.getParentNode(),n,a))},setChkClass:function(e,t,n){t&&(!0===n.nocheck?t.hide():t.show(),t.attr("class",l.makeChkClass(e,n)))},setParentNodeCheckBox:function(e,t,n,a){var o=e.data.key.children,i=e.data.key.checked,r=c(t,s.id.CHECK,e);if(a||(a=t),d.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled&&(t[i]=n,l.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=a&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t])),t.parentTId){var p=!0;if(!n)for(var u=t.getParentNode()[o],h=0,m=u.length;h<m;h++)if(!0!==u[h].nocheck&&!0!==u[h].chkDisabled&&u[h][i]||(!0===u[h].nocheck||!0===u[h].chkDisabled)&&u[h].check_Child_State>0){p=!1;break}p&&l.setParentNodeCheckBox(e,t.getParentNode(),n,a)}},setSonNodeCheckBox:function(e,t,n,a){if(t){var o=e.data.key.children,i=e.data.key.checked,r=c(t,s.id.CHECK,e);a||(a=t);var p=!1;if(t[o])for(var u=0,h=t[o].length;u<h;u++){var m=t[o][u];l.setSonNodeCheckBox(e,m,n,a),!0===m.chkDisabled&&(p=!0)}t!=d.getRoot(e)&&!0!==t.chkDisabled&&(p&&!0!==t.nocheck&&d.makeChkFlag(e,t),!0!==t.nocheck&&!0!==t.chkDisabled?(t[i]=n,p||(t.check_Child_State=t[o]&&t[o].length>0?n?2:0:-1)):t.check_Child_State=-1,l.setChkClass(e,r,t),e.check.autoCheckTrigger&&t!=a&&!0!==t.nocheck&&!0!==t.chkDisabled&&e.treeObj.trigger(s.event.CHECK,[null,e.treeId,t]))}}},event:{},data:{getRadioCheckedList:function(e){for(var t=d.getRoot(e).radioCheckedList,n=0,a=t.length;n<a;n++)d.getNodeCache(e,t[n].tId)||(t.splice(n,1),n--,a--);return t},getCheckStatus:function(e,t){if(!e.check.enable||t.nocheck||t.chkDisabled)return null;var n=e.data.key.checked;return{checked:t[n],half:t.halfCheck?t.halfCheck:e.check.chkStyle==s.radio.STYLE?2===t.check_Child_State:t[n]?t.check_Child_State>-1&&t.check_Child_State<2:t.check_Child_State>0}},getTreeCheckedNodes:function(e,t,n,a){if(!t)return[];var o=e.data.key.children,i=e.data.key.checked,r=n&&e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL;a=a||[];for(var l=0,c=t.length;l<c&&(!0===t[l].nocheck||!0===t[l].chkDisabled||t[l][i]!=n||(a.push(t[l]),!r))&&(d.getTreeCheckedNodes(e,t[l][o],n,a),!(r&&a.length>0));l++);return a},getTreeChangeCheckedNodes:function(e,t,n){if(!t)return[];var a=e.data.key.children,o=e.data.key.checked;n=n||[];for(var i=0,r=t.length;i<r;i++)!0!==t[i].nocheck&&!0!==t[i].chkDisabled&&t[i][o]!=t[i].checkedOld&&n.push(t[i]),d.getTreeChangeCheckedNodes(e,t[i][a],n);return n},makeChkFlag:function(e,t){if(t){var n=e.data.key.children,a=e.data.key.checked,o=-1;if(t[n])for(var i=0,r=t[n].length;i<r;i++){var l=t[n][i],d=-1;if(e.check.chkStyle==s.radio.STYLE){if(2==(d=!0===l.nocheck||!0===l.chkDisabled?l.check_Child_State:!0===l.halfCheck||l[a]||l.check_Child_State>0?2:0)){o=2;break}0==d&&(o=0)}else if(e.check.chkStyle==s.checkbox.STYLE){if(1===(d=!0===l.nocheck||!0===l.chkDisabled?l.check_Child_State:!0===l.halfCheck?1:l[a]?-1===l.check_Child_State||2===l.check_Child_State?2:1:l.check_Child_State>0?1:0)){o=1;break}if(2===d&&o>-1&&i>0&&d!==o){o=1;break}if(2===o&&d>-1&&d<2){o=1;break}d>-1&&(o=d)}}t.check_Child_State=o}}}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,o);var i=e.fn.zTree,r=i._z.tools,s=i.consts,l=i._z.view,d=i._z.data,c=(i._z.event,r.$);d.exSetting(n),d.addInitBind((function(e){var t=e.treeObj,n=s.event;t.bind(n.CHECK,(function(t,n,a,o){t.srcEvent=n,r.apply(e.callback.onCheck,[t,a,o])}))})),d.addInitUnBind((function(e){var t=e.treeObj,n=s.event;t.unbind(n.CHECK)})),d.addInitCache((function(e){})),d.addInitNode((function(e,t,n,a,o,i,l){if(n){var c=e.data.key.checked;if("string"==typeof n[c]&&(n[c]=r.eqs(n[c],"true")),n[c]=!!n[c],n.checkedOld=n[c],"string"==typeof n.nocheck&&(n.nocheck=r.eqs(n.nocheck,"true")),n.nocheck=!!n.nocheck||e.check.nocheckInherit&&a&&!!a.nocheck,"string"==typeof n.chkDisabled&&(n.chkDisabled=r.eqs(n.chkDisabled,"true")),n.chkDisabled=!!n.chkDisabled||e.check.chkDisabledInherit&&a&&!!a.chkDisabled,"string"==typeof n.halfCheck&&(n.halfCheck=r.eqs(n.halfCheck,"true")),n.halfCheck=!!n.halfCheck,n.check_Child_State=-1,n.check_Focus=!1,n.getCheckStatus=function(){return d.getCheckStatus(e,n)},e.check.chkStyle==s.radio.STYLE&&e.check.radioType==s.radio.TYPE_ALL&&n[c])d.getRoot(e).radioCheckedList.push(n)}})),d.addInitProxy((function(e){var t=e.target,n=d.getSetting(e.data.treeId),o="",i=null,l="",c=null;if(r.eqs(e.type,"mouseover")?n.check.enable&&r.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+s.id.CHECK)&&(o=r.getNodeMainDom(t).id,l="mouseoverCheck"):r.eqs(e.type,"mouseout")?n.check.enable&&r.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+s.id.CHECK)&&(o=r.getNodeMainDom(t).id,l="mouseoutCheck"):r.eqs(e.type,"click")&&n.check.enable&&r.eqs(t.tagName,"span")&&null!==t.getAttribute("treeNode"+s.id.CHECK)&&(o=r.getNodeMainDom(t).id,l="checkNode"),o.length>0)switch(i=d.getNodeCache(n,o),l){case"checkNode":c=a.onCheckNode;break;case"mouseoverCheck":c=a.onMouseoverCheck;break;case"mouseoutCheck":c=a.onMouseoutCheck}return{stop:"checkNode"===l,node:i,nodeEventType:l,nodeEventCallback:c,treeEventType:"",treeEventCallback:null}}),!0),d.addInitRoot((function(e){d.getRoot(e).radioCheckedList=[]})),d.addBeforeA((function(e,t,n){e.data.key.checked;e.check.enable&&(d.makeChkFlag(e,t),n.push("<span ID='",t.tId,s.id.CHECK,"' class='",l.makeChkClass(e,t),"' treeNode",s.id.CHECK,!0===t.nocheck?" style='display:none;'":"","></span>"))})),d.addZTreeTools((function(e,t){t.checkNode=function(e,t,n,a){var o=this.setting.data.key.checked;if(!0!==e.chkDisabled&&(!0!==t&&!1!==t&&(t=!e[o]),a=!!a,(e[o]!==t||n)&&(!a||0!=r.apply(this.setting.callback.beforeCheck,[this.setting.treeId,e],!0))&&r.uCanDo(this.setting)&&this.setting.check.enable&&!0!==e.nocheck)){e[o]=t;var i=c(e,s.id.CHECK,this.setting);(n||this.setting.check.chkStyle===s.radio.STYLE)&&l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,i,e),l.repairParentChkClassWithSelf(this.setting,e),a&&this.setting.treeObj.trigger(s.event.CHECK,[null,this.setting.treeId,e])}},t.checkAllNodes=function(e){l.repairAllChk(this.setting,!!e)},t.getCheckedNodes=function(e){var t=this.setting.data.key.children;return e=!1!==e,d.getTreeCheckedNodes(this.setting,d.getRoot(this.setting)[t],e)},t.getChangeCheckedNodes=function(){var e=this.setting.data.key.children;return d.getTreeChangeCheckedNodes(this.setting,d.getRoot(this.setting)[e])},t.setChkDisabled=function(e,t,n,a){t=!!t,n=!!n,a=!!a,l.repairSonChkDisabled(this.setting,e,t,a),l.repairParentChkDisabled(this.setting,e.getParentNode(),t,n)};var n=t.updateNode;t.updateNode=function(e,a){if(n&&n.apply(t,arguments),e&&this.setting.check.enable){var o=c(e,this.setting);if(o.get(0)&&r.uCanDo(this.setting)){var i=c(e,s.id.CHECK,this.setting);1!=a&&this.setting.check.chkStyle!==s.radio.STYLE||l.checkNodeRelation(this.setting,e),l.setChkClass(this.setting,i,e),l.repairParentChkClassWithSelf(this.setting,e)}}}}));var p=l.createNodes;l.createNodes=function(e,t,n,a,o){p&&p.apply(l,arguments),n&&l.repairParentChkClassWithSelf(e,a)};var u=l.removeNode;l.removeNode=function(e,t){var n=t.getParentNode();u&&u.apply(l,arguments),t&&n&&(l.repairChkClass(e,n),l.repairParentChkClass(e,n))};var h=l.appendNodes;l.appendNodes=function(e,t,n,a,o,i,r){var s="";return h&&(s=h.apply(l,arguments)),a&&d.makeChkFlag(e,a),s}}(jQuery),function(e){var t={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},n={onHoverOverNode:function(e,t){var a=l.getSetting(e.data.treeId),o=l.getRoot(a);o.curHoverNode!=t&&n.onHoverOutNode(e),o.curHoverNode=t,s.addHoverDom(a,t)},onHoverOutNode:function(e,t){var n=l.getSetting(e.data.treeId),a=l.getRoot(n);a.curHoverNode&&!l.isSelectedNode(n,a.curHoverNode)&&(s.removeTreeDom(n,a.curHoverNode),a.curHoverNode=null)},onMousedownNode:function(n,a){var o,c,p=l.getSetting(n.data.treeId),u=l.getRoot(p),h=l.getRoots();if(2==n.button||!p.edit.enable||!p.edit.drag.isCopy&&!p.edit.drag.isMove)return!0;var m=n.target,g=l.getRoot(p).curSelectedList,f=[];if(l.isSelectedNode(p,a))for(o=0,c=g.length;o<c;o++){if(g[o].editNameFlag&&i.eqs(m.tagName,"input")&&null!==m.getAttribute("treeNode"+r.id.INPUT))return!0;if(f.push(g[o]),f[0].parentTId!==g[o].parentTId){f=[a];break}}else f=[a];s.editNodeBlur=!0,s.cancelCurEditNode(p);var v,N,C,k,E,b=e(p.treeObj.get(0).ownerDocument),y=e(p.treeObj.get(0).ownerDocument.body),T=!1,I=p,A=p,S=null,w=null,x=null,P=r.move.TYPE_INNER,O=n.clientX,D=n.clientY,L=(new Date).getTime();function R(n){if(0==u.dragFlag&&Math.abs(O-n.clientX)<p.edit.drag.minMoveSize&&Math.abs(D-n.clientY)<p.edit.drag.minMoveSize)return!0;var a,o,c,m,g,A=p.data.key.children;if(y.css("cursor","pointer"),0==u.dragFlag){if(0==i.apply(p.callback.beforeDrag,[p.treeId,f],!0))return M(n),!0;for(a=0,o=f.length;a<o;a++)0==a&&(u.dragNodeShowBefore=[]),(c=f[a]).isParent&&c.open?(s.expandCollapseNode(p,c,!c.open),u.dragNodeShowBefore[c.tId]=!0):u.dragNodeShowBefore[c.tId]=!1;u.dragFlag=1,h.showHoverDom=!1,i.showIfameMask(p,!0);var R=!0,_=-1;if(f.length>1){var j=f[0].parentTId?f[0].getParentNode()[A]:l.getNodes(p);for(g=[],a=0,o=j.length;a<o;a++)if(void 0!==u.dragNodeShowBefore[j[a].tId]&&(R&&_>-1&&_+1!==a&&(R=!1),g.push(j[a]),_=a),f.length===g.length){f=g;break}}for(R&&(k=f[0].getPreNode(),E=f[f.length-1].getNextNode()),v=d("<ul class='zTreeDragUL'></ul>",p),a=0,o=f.length;a<o;a++)(c=f[a]).editNameFlag=!1,s.selectNode(p,c,a>0),s.removeTreeDom(p,c),a>p.edit.drag.maxShowNodeNum-1||((m=d("<li id='"+c.tId+"_tmp'></li>",p)).append(d(c,r.id.A,p).clone()),m.css("padding","0"),m.children("#"+c.tId+r.id.A).removeClass(r.node.CURSELECTED),v.append(m),a==p.edit.drag.maxShowNodeNum-1&&(m=d("<li id='"+c.tId+"_moretmp'><a>  ...  </a></li>",p),v.append(m)));v.attr("id",f[0].tId+r.id.UL+"_tmp"),v.addClass(p.treeObj.attr("class")),v.appendTo(y),(N=d("<span class='tmpzTreeMove_arrow'></span>",p)).attr("id","zTreeMove_arrow_tmp"),N.appendTo(y),p.treeObj.trigger(r.event.DRAG,[n,p.treeId,f])}if(1==u.dragFlag){if(C&&N.attr("id")==n.target.id&&x&&n.clientX+b.scrollLeft()+2>e("#"+x+r.id.A,C).offset().left){var B=e("#"+x+r.id.A,C);n.target=B.length>0?B.get(0):n.target}else C&&(C.removeClass(r.node.TMPTARGET_TREE),x&&e("#"+x+r.id.A,C).removeClass(r.node.TMPTARGET_NODE+"_"+r.move.TYPE_PREV).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER));C=null,x=null,T=!1,I=p;var F=l.getSettings();for(var z in F)F[z].treeId&&F[z].edit.enable&&F[z].treeId!=p.treeId&&(n.target.id==F[z].treeId||e(n.target).parents("#"+F[z].treeId).length>0)&&(T=!0,I=F[z]);var U=b.scrollTop(),V=b.scrollLeft(),Y=I.treeObj.offset(),K=I.treeObj.get(0).scrollHeight,H=I.treeObj.get(0).scrollWidth,$=n.clientY+U-Y.top,W=I.treeObj.height()+Y.top-n.clientY-U,G=n.clientX+V-Y.left,Z=I.treeObj.width()+Y.left-n.clientX-V,J=$<p.edit.drag.borderMax&&$>p.edit.drag.borderMin,X=W<p.edit.drag.borderMax&&W>p.edit.drag.borderMin,q=G<p.edit.drag.borderMax&&G>p.edit.drag.borderMin,Q=Z<p.edit.drag.borderMax&&Z>p.edit.drag.borderMin,ee=$>p.edit.drag.borderMin&&W>p.edit.drag.borderMin&&G>p.edit.drag.borderMin&&Z>p.edit.drag.borderMin,te=J&&I.treeObj.scrollTop()<=0,ne=X&&I.treeObj.scrollTop()+I.treeObj.height()+10>=K,ae=q&&I.treeObj.scrollLeft()<=0,oe=Q&&I.treeObj.scrollLeft()+I.treeObj.width()+10>=H;if(n.target&&i.isChildOrSelf(n.target,I.treeId)){for(var ie=n.target;ie&&ie.tagName&&!i.eqs(ie.tagName,"li")&&ie.id!=I.treeId;)ie=ie.parentNode;var re=!0;for(a=0,o=f.length;a<o;a++){if(c=f[a],ie.id===c.tId){re=!1;break}if(d(c,p).find("#"+ie.id).length>0){re=!1;break}}re&&n.target&&i.isChildOrSelf(n.target,ie.id+r.id.A)&&(C=e(ie),x=ie.id)}c=f[0],ee&&i.isChildOrSelf(n.target,I.treeId)&&(!C&&(n.target.id==I.treeId||te||ne||ae||oe)&&(T||!T&&c.parentTId)&&(C=I.treeObj),J?I.treeObj.scrollTop(I.treeObj.scrollTop()-10):X&&I.treeObj.scrollTop(I.treeObj.scrollTop()+10),q?I.treeObj.scrollLeft(I.treeObj.scrollLeft()-10):Q&&I.treeObj.scrollLeft(I.treeObj.scrollLeft()+10),C&&C!=I.treeObj&&C.offset().left<I.treeObj.offset().left&&I.treeObj.scrollLeft(I.treeObj.scrollLeft()+C.offset().left-I.treeObj.offset().left)),v.css({top:n.clientY+U+3+"px",left:n.clientX+V+3+"px"});var se=0,le=0;if(C&&C.attr("id")!=I.treeId){var de=null==x?null:l.getNodeCache(I,x),ce=(n.ctrlKey||n.metaKey)&&p.edit.drag.isMove&&p.edit.drag.isCopy||!p.edit.drag.isMove&&p.edit.drag.isCopy,pe=!(!k||x!==k.tId),ue=!(!E||x!==E.tId),he=c.parentTId&&c.parentTId==x,me=(ce||!ue)&&i.apply(I.edit.drag.prev,[I.treeId,f,de],!!I.edit.drag.prev),ge=(ce||!pe)&&i.apply(I.edit.drag.next,[I.treeId,f,de],!!I.edit.drag.next),fe=(ce||!he)&&!(I.data.keep.leaf&&!de.isParent)&&i.apply(I.edit.drag.inner,[I.treeId,f,de],!!I.edit.drag.inner);function ve(){C=null,x="",P=r.move.TYPE_INNER,N.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)}if(me||ge||fe){var Ne=e("#"+x+r.id.A,C),Ce=de.isLastNode?null:e("#"+de.getNextNode().tId+r.id.A,C.next()),ke=Ne.offset().top,Ee=Ne.offset().left,be=me?fe?.25:ge?.5:1:-1,ye=ge?fe?.75:me?.5:0:-1,Te=(n.clientY+U-ke)/Ne.height();if((1==be||Te<=be&&Te>=-.2)&&me?(se=1-N.width(),le=ke-N.height()/2,P=r.move.TYPE_PREV):(0==ye||Te>=ye&&Te<=1.2)&&ge?(se=1-N.width(),le=null==Ce||de.isParent&&de.open?ke+Ne.height()-N.height()/2:Ce.offset().top-N.height()/2,P=r.move.TYPE_NEXT):fe?(se=5-N.width(),le=ke,P=r.move.TYPE_INNER):ve(),C&&(N.css({display:"block",top:le+"px",left:Ee+se+"px"}),Ne.addClass(r.node.TMPTARGET_NODE+"_"+P),S==x&&w==P||(L=(new Date).getTime()),de&&de.isParent&&P==r.move.TYPE_INNER)){var Ie=!0;window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==de.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===de.tId&&(Ie=!1),Ie&&(window.zTreeMoveTimer=setTimeout((function(){P==r.move.TYPE_INNER&&de&&de.isParent&&!de.open&&(new Date).getTime()-L>I.edit.drag.autoOpenTime&&i.apply(I.callback.beforeDragOpen,[I.treeId,de],!0)&&(s.switchNode(I,de),I.edit.drag.autoExpandTrigger&&I.treeObj.trigger(r.event.EXPAND,[I.treeId,de]))}),I.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=de.tId)}}else ve()}else P=r.move.TYPE_INNER,C&&i.apply(I.edit.drag.inner,[I.treeId,f,null],!!I.edit.drag.inner)?C.addClass(r.node.TMPTARGET_TREE):C=null,N.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);S=x,w=P,p.treeObj.trigger(r.event.DRAGMOVE,[n,p.treeId,f])}return!1}function M(n){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),S=null,w=null,b.unbind("mousemove",R),b.unbind("mouseup",M),b.unbind("selectstart",_),y.css("cursor","auto"),C&&(C.removeClass(r.node.TMPTARGET_TREE),x&&e("#"+x+r.id.A,C).removeClass(r.node.TMPTARGET_NODE+"_"+r.move.TYPE_PREV).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_NEXT).removeClass(r.node.TMPTARGET_NODE+"_"+t.move.TYPE_INNER)),i.showIfameMask(p,!1),h.showHoverDom=!0,0!=u.dragFlag){var a,o,c;for(u.dragFlag=0,a=0,o=f.length;a<o;a++)(c=f[a]).isParent&&u.dragNodeShowBefore[c.tId]&&!c.open&&(s.expandCollapseNode(p,c,!c.open),delete u.dragNodeShowBefore[c.tId]);v&&v.remove(),N&&N.remove();var m=(n.ctrlKey||n.metaKey)&&p.edit.drag.isMove&&p.edit.drag.isCopy||!p.edit.drag.isMove&&p.edit.drag.isCopy;if(!m&&C&&x&&f[0].parentTId&&x==f[0].parentTId&&P==r.move.TYPE_INNER&&(C=null),C){var g=null==x?null:l.getNodeCache(I,x);if(0==i.apply(p.callback.beforeDrop,[I.treeId,f,g,P,m],!0))return void s.selectNodes(A,f);var k=m?i.clone(f):f;function E(){if(T){if(!m)for(var e=0,t=f.length;e<t;e++)s.removeNode(p,f[e]);P==r.move.TYPE_INNER?s.addNodes(I,g,-1,k):s.addNodes(I,g.getParentNode(),P==r.move.TYPE_PREV?g.getIndex():g.getIndex()+1,k)}else if(m&&P==r.move.TYPE_INNER)s.addNodes(I,g,-1,k);else if(m)s.addNodes(I,g.getParentNode(),P==r.move.TYPE_PREV?g.getIndex():g.getIndex()+1,k);else if(P!=r.move.TYPE_NEXT)for(e=0,t=k.length;e<t;e++)s.moveNode(I,g,k[e],P,!1);else for(e=-1,t=k.length-1;e<t;t--)s.moveNode(I,g,k[t],P,!1);s.selectNodes(I,k);var a=d(k[0],p).get(0);s.scrollIntoView(a),p.treeObj.trigger(r.event.DROP,[n,I.treeId,k,g,P,m])}P==r.move.TYPE_INNER&&i.canAsync(I,g)?s.asyncNode(I,g,!1,E):E()}else s.selectNodes(A,f),p.treeObj.trigger(r.event.DROP,[n,p.treeId,f,null,null,null])}}function _(){return!1}return i.uCanDo(p)&&b.bind("mousemove",R),b.bind("mouseup",M),b.bind("selectstart",_),n.preventDefault&&n.preventDefault(),!0}},a={tools:{getAbs:function(e){var t=e.getBoundingClientRect(),n=document.body.scrollTop+document.documentElement.scrollTop,a=document.body.scrollLeft+document.documentElement.scrollLeft;return[t.left+a,t.top+n]},inputFocus:function(e){e.get(0)&&(e.focus(),i.setCursorPosition(e.get(0),e.val().length))},inputSelect:function(e){e.get(0)&&(e.focus(),e.select())},setCursorPosition:function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}},showIfameMask:function(e,t){for(var n=l.getRoot(e);n.dragMaskList.length>0;)n.dragMaskList[0].remove(),n.dragMaskList.shift();if(t)for(var a=d("iframe",e),o=0,r=a.length;o<r;o++){var s=a.get(o),c=i.getAbs(s),p=d("<div id='zTreeMask_"+o+"' class='zTreeMask' style='top:"+c[1]+"px; left:"+c[0]+"px; width:"+s.offsetWidth+"px; height:"+s.offsetHeight+"px;'></div>",e);p.appendTo(d("body",e)),n.dragMaskList.push(p)}}},view:{addEditBtn:function(e,t){if(!(t.editNameFlag||d(t,r.id.EDIT,e).length>0)&&i.apply(e.edit.showRenameBtn,[e.treeId,t],e.edit.showRenameBtn)){var n=d(t,r.id.A,e),a="<span class='"+r.className.BUTTON+" edit' id='"+t.tId+r.id.EDIT+"' title='"+i.apply(e.edit.renameTitle,[e.treeId,t],e.edit.renameTitle)+"' treeNode"+r.id.EDIT+" style='display:none;'></span>";n.append(a),d(t,r.id.EDIT,e).bind("click",(function(){return!(!i.uCanDo(e)||0==i.apply(e.callback.beforeEditName,[e.treeId,t],!0))&&(s.editNode(e,t),!1)})).show()}},addRemoveBtn:function(e,t){if(!(t.editNameFlag||d(t,r.id.REMOVE,e).length>0)&&i.apply(e.edit.showRemoveBtn,[e.treeId,t],e.edit.showRemoveBtn)){var n=d(t,r.id.A,e),a="<span class='"+r.className.BUTTON+" remove' id='"+t.tId+r.id.REMOVE+"' title='"+i.apply(e.edit.removeTitle,[e.treeId,t],e.edit.removeTitle)+"' treeNode"+r.id.REMOVE+" style='display:none;'></span>";n.append(a),d(t,r.id.REMOVE,e).bind("click",(function(){return!(!i.uCanDo(e)||0==i.apply(e.callback.beforeRemove,[e.treeId,t],!0))&&(s.removeNode(e,t),e.treeObj.trigger(r.event.REMOVE,[e.treeId,t]),!1)})).bind("mousedown",(function(e){return!0})).show()}},addHoverDom:function(e,t){l.getRoots().showHoverDom&&(t.isHover=!0,e.edit.enable&&(s.addEditBtn(e,t),s.addRemoveBtn(e,t)),i.apply(e.view.addHoverDom,[e.treeId,t]))},cancelCurEditNode:function(e,t,n){var a=l.getRoot(e),o=e.data.key.name,c=a.curEditNode;if(c){var p=a.curEditInput,u=t||(n?c[o]:p.val());if(!1===i.apply(e.callback.beforeRename,[e.treeId,c,u,n],!0))return!1;c[o]=u,d(c,r.id.A,e).removeClass(r.node.CURSELECTED_EDIT),p.unbind(),s.setNodeName(e,c),c.editNameFlag=!1,a.curEditNode=null,a.curEditInput=null,s.selectNode(e,c,!1),e.treeObj.trigger(r.event.RENAME,[e.treeId,c,n])}return a.noSelection=!0,!0},editNode:function(e,t){var n=l.getRoot(e);if(s.editNodeBlur=!1,l.isSelectedNode(e,t)&&n.curEditNode==t&&t.editNameFlag)setTimeout((function(){i.inputFocus(n.curEditInput)}),0);else{var a=e.data.key.name;t.editNameFlag=!0,s.removeTreeDom(e,t),s.cancelCurEditNode(e),s.selectNode(e,t,!1),d(t,r.id.SPAN,e).html("<input type=text class='rename' id='"+t.tId+r.id.INPUT+"' treeNode"+r.id.INPUT+" >");var o=d(t,r.id.INPUT,e);o.attr("value",t[a]),e.edit.editNameSelectAll?i.inputSelect(o):i.inputFocus(o),o.bind("blur",(function(t){s.editNodeBlur||s.cancelCurEditNode(e)})).bind("keydown",(function(t){"13"==t.keyCode?(s.editNodeBlur=!0,s.cancelCurEditNode(e)):"27"==t.keyCode&&s.cancelCurEditNode(e,null,!0)})).bind("click",(function(e){return!1})).bind("dblclick",(function(e){return!1})),d(t,r.id.A,e).addClass(r.node.CURSELECTED_EDIT),n.curEditInput=o,n.noSelection=!1,n.curEditNode=t}},moveNode:function(e,t,n,a,o,i){var c=l.getRoot(e),p=e.data.key.children;if(t!=n&&(!e.data.keep.leaf||!t||t.isParent||a!=r.move.TYPE_INNER)){var u=n.parentTId?n.getParentNode():c,h=null===t||t==c;h&&null===t&&(t=c),h&&(a=r.move.TYPE_INNER);var m,g,f=t.parentTId?t.getParentNode():c;if(a!=r.move.TYPE_PREV&&a!=r.move.TYPE_NEXT&&(a=r.move.TYPE_INNER),a==r.move.TYPE_INNER&&(h?n.parentTId=null:(t.isParent||(t.isParent=!0,t.open=!!t.open,s.setNodeLineIcos(e,t)),n.parentTId=t.tId)),h)g=m=e.treeObj;else{if(i||a!=r.move.TYPE_INNER?i||s.expandCollapseNode(e,t.getParentNode(),!0,!1):s.expandCollapseNode(e,t,!0,!1),m=d(t,e),g=d(t,r.id.UL,e),m.get(0)&&!g.get(0)){var v=[];s.makeUlHtml(e,t,v,""),m.append(v.join(""))}g=d(t,r.id.UL,e)}var N=d(n,e);N.get(0)?m.get(0)||N.remove():N=s.appendNodes(e,n.level,[n],null,-1,!1,!0).join(""),g.get(0)&&a==r.move.TYPE_INNER?g.append(N):m.get(0)&&a==r.move.TYPE_PREV?m.before(N):m.get(0)&&a==r.move.TYPE_NEXT&&m.after(N);var C,k,E=-1,b=0,y=null,T=null,I=n.level;if(n.isFirstNode)E=0,u[p].length>1&&((y=u[p][1]).isFirstNode=!0);else if(n.isLastNode)E=u[p].length-1,(y=u[p][E-1]).isLastNode=!0;else for(C=0,k=u[p].length;C<k;C++)if(u[p][C].tId==n.tId){E=C;break}if(E>=0&&u[p].splice(E,1),a!=r.move.TYPE_INNER)for(C=0,k=f[p].length;C<k;C++)f[p][C].tId==t.tId&&(b=C);if(a==r.move.TYPE_INNER?(t[p]||(t[p]=new Array),t[p].length>0&&((T=t[p][t[p].length-1]).isLastNode=!1),t[p].splice(t[p].length,0,n),n.isLastNode=!0,n.isFirstNode=1==t[p].length):t.isFirstNode&&a==r.move.TYPE_PREV?(f[p].splice(b,0,n),(T=t).isFirstNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!0,n.isLastNode=!1):t.isLastNode&&a==r.move.TYPE_NEXT?(f[p].splice(b+1,0,n),(T=t).isLastNode=!1,n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!0):(a==r.move.TYPE_PREV?f[p].splice(b,0,n):f[p].splice(b+1,0,n),n.parentTId=t.parentTId,n.isFirstNode=!1,n.isLastNode=!1),l.fixPIdKeyValue(e,n),l.setSonNodeLevel(e,n.getParentNode(),n),s.setNodeLineIcos(e,n),s.repairNodeLevelClass(e,n,I),!e.data.keep.parent&&u[p].length<1){u.isParent=!1,u.open=!1;var A=d(u,r.id.UL,e),S=d(u,r.id.SWITCH,e),w=d(u,r.id.ICON,e);s.replaceSwitchClass(u,S,r.folder.DOCU),s.replaceIcoClass(u,w,r.folder.DOCU),A.css("display","none")}else y&&s.setNodeLineIcos(e,y);T&&s.setNodeLineIcos(e,T),e.check&&e.check.enable&&s.repairChkClass&&(s.repairChkClass(e,u),s.repairParentChkClassWithSelf(e,u),u!=n.parent&&s.repairParentChkClassWithSelf(e,n)),i||s.expandCollapseParentNode(e,n.getParentNode(),!0,o)}},removeEditBtn:function(e,t){d(t,r.id.EDIT,e).unbind().remove()},removeRemoveBtn:function(e,t){d(t,r.id.REMOVE,e).unbind().remove()},removeTreeDom:function(e,t){t.isHover=!1,s.removeEditBtn(e,t),s.removeRemoveBtn(e,t),i.apply(e.view.removeHoverDom,[e.treeId,t])},repairNodeLevelClass:function(e,t,n){if(n!==t.level){var a=d(t,e),o=d(t,r.id.A,e),i=d(t,r.id.UL,e),s=r.className.LEVEL+n,l=r.className.LEVEL+t.level;a.removeClass(s),a.addClass(l),o.removeClass(s),o.addClass(l),i.removeClass(s),i.addClass(l)}},selectNodes:function(e,t){for(var n=0,a=t.length;n<a;n++)s.selectNode(e,t[n],n>0)}},event:{},data:{setSonNodeLevel:function(e,t,n){if(n){var a=e.data.key.children;if(n.level=t?t.level+1:0,n[a])for(var o=0,i=n[a].length;o<i;o++)n[a][o]&&l.setSonNodeLevel(e,n,n[a][o])}}}};e.extend(!0,e.fn.zTree.consts,t),e.extend(!0,e.fn.zTree._z,a);var o=e.fn.zTree,i=o._z.tools,r=o.consts,s=o._z.view,l=o._z.data,d=(o._z.event,i.$);l.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),l.addInitBind((function(e){var t=e.treeObj,n=r.event;t.bind(n.RENAME,(function(t,n,a,o){i.apply(e.callback.onRename,[t,n,a,o])})),t.bind(n.DRAG,(function(t,n,a,o){i.apply(e.callback.onDrag,[n,a,o])})),t.bind(n.DRAGMOVE,(function(t,n,a,o){i.apply(e.callback.onDragMove,[n,a,o])})),t.bind(n.DROP,(function(t,n,a,o,r,s,l){i.apply(e.callback.onDrop,[n,a,o,r,s,l])}))})),l.addInitUnBind((function(e){var t=e.treeObj,n=r.event;t.unbind(n.RENAME),t.unbind(n.DRAG),t.unbind(n.DRAGMOVE),t.unbind(n.DROP)})),l.addInitCache((function(e){})),l.addInitNode((function(e,t,n,a,o,i,r){n&&(n.isHover=!1,n.editNameFlag=!1)})),l.addInitProxy((function(e){var t=e.target,a=l.getSetting(e.data.treeId),o=e.relatedTarget,s="",d=null,c="",p=null,u=null;if(i.eqs(e.type,"mouseover")?(u=i.getMDom(a,t,[{tagName:"a",attrName:"treeNode"+r.id.A}]))&&(s=i.getNodeMainDom(u).id,c="hoverOverNode"):i.eqs(e.type,"mouseout")?(u=i.getMDom(a,o,[{tagName:"a",attrName:"treeNode"+r.id.A}]))||(s="remove",c="hoverOutNode"):i.eqs(e.type,"mousedown")&&(u=i.getMDom(a,t,[{tagName:"a",attrName:"treeNode"+r.id.A}]))&&(s=i.getNodeMainDom(u).id,c="mousedownNode"),s.length>0)switch(d=l.getNodeCache(a,s),c){case"mousedownNode":p=n.onMousedownNode;break;case"hoverOverNode":p=n.onHoverOverNode;break;case"hoverOutNode":p=n.onHoverOutNode}return{stop:!1,node:d,nodeEventType:c,nodeEventCallback:p,treeEventType:"",treeEventCallback:null}})),l.addInitRoot((function(e){var t=l.getRoot(e),n=l.getRoots();t.curEditNode=null,t.curEditInput=null,t.curHoverNode=null,t.dragFlag=0,t.dragNodeShowBefore=[],t.dragMaskList=new Array,n.showHoverDom=!0})),l.addZTreeTools((function(e,t){t.cancelEditName=function(e){l.getRoot(this.setting).curEditNode&&s.cancelCurEditNode(this.setting,e||null,!0)},t.copyNode=function(e,t,n,a){if(!t)return null;if(e&&!e.isParent&&this.setting.data.keep.leaf&&n===r.move.TYPE_INNER)return null;var o=this,l=i.clone(t);if(e||(e=null,n=r.move.TYPE_INNER),n==r.move.TYPE_INNER){function d(){s.addNodes(o.setting,e,-1,[l],a)}i.canAsync(this.setting,e)?s.asyncNode(this.setting,e,a,d):d()}else s.addNodes(this.setting,e.parentNode,-1,[l],a),s.moveNode(this.setting,e,l,n,!1,a);return l},t.editName=function(e){e&&e.tId&&e===l.getNodeCache(this.setting,e.tId)&&(e.parentTId&&s.expandCollapseParentNode(this.setting,e.getParentNode(),!0),s.editNode(this.setting,e))},t.moveNode=function(e,t,n,a){if(!t)return t;if(e&&!e.isParent&&this.setting.data.keep.leaf&&n===r.move.TYPE_INNER)return null;if(e&&(t.parentTId==e.tId&&n==r.move.TYPE_INNER||d(t,this.setting).find("#"+e.tId).length>0))return null;e||(e=null);var o=this;function l(){s.moveNode(o.setting,e,t,n,!1,a)}return i.canAsync(this.setting,e)&&n===r.move.TYPE_INNER?s.asyncNode(this.setting,e,a,l):l(),t},t.setEditable=function(e){return this.setting.edit.enable=e,this.refresh()}}));var c=s.cancelPreSelectedNode;s.cancelPreSelectedNode=function(e,t){for(var n=l.getRoot(e).curSelectedList,a=0,o=n.length;a<o&&(t&&t!==n[a]||(s.removeTreeDom(e,n[a]),!t));a++);c&&c.apply(s,arguments)};var p=s.createNodes;s.createNodes=function(e,t,n,a,o){p&&p.apply(s,arguments),n&&s.repairParentChkClassWithSelf&&s.repairParentChkClassWithSelf(e,a)};var u=s.makeNodeUrl;s.makeNodeUrl=function(e,t){return e.edit.enable?null:u.apply(s,arguments)};var h=s.removeNode;s.removeNode=function(e,t){var n=l.getRoot(e);n.curEditNode===t&&(n.curEditNode=null),h&&h.apply(s,arguments)};var m=s.selectNode;s.selectNode=function(e,t,n){var a=l.getRoot(e);return(!l.isSelectedNode(e,t)||a.curEditNode!=t||!t.editNameFlag)&&(m&&m.apply(s,arguments),s.addHoverDom(e,t),!0)};var g=i.uCanDo;i.uCanDo=function(e,t){var n=l.getRoot(e);return!(!t||!(i.eqs(t.type,"mouseover")||i.eqs(t.type,"mouseout")||i.eqs(t.type,"mousedown")||i.eqs(t.type,"mouseup")))||(n.curEditNode&&(s.editNodeBlur=!1,n.curEditInput.focus()),!n.curEditNode&&(!g||g.apply(s,arguments)))}}(jQuery)},1470:function(e,t,n){},1471:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABKCAYAAABaZmHbAAAB6klEQVR4nO3dv2oUUQBG8TOzhBiCVoLYarARH0DFSqxiae9zmMrORkjjC1iGba1crEQLHyFiuyBYGYKkkLW4UURCdicwe/0u59csOzvFB2dn/1TTUdwEngEPgMvof3QEvAdeAF86YAd4A1ypuUor+w48ngAvgduVx2h1m8D1DvgMbFceo2GOe4yWaLuvvUAXY7hQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UIYLZbhQhgtluFCGC2W4UD2wqD1Cgy16YF57hQab98C09goNNp0An4A7wI3KY7SaGbDXnT7pgEeU25BtVpt0MZeAJwPOnwInI20Z0wnlNmQzYNEtOTnFa8obb5kZ8HTkLWvRSrhbwDtgcs45P4GHwOFaFo2slf9xh8DBknMOaCQatHPFAVwDPgJbZ7z2A7gHfF3rohGd99GS5pjyw+ruGa+9At6ud864WrrioNyY9wNw9a9j34D7lJvDNqOV77jfjoD9f47t01i0Vm1Qrrr56eNG3TkaYpcSbrf2EA3TAc9p7zv8j18tZC7p4u6S5AAAAABJRU5ErkJggg=="},1472:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAABB0lEQVQ4ja3TvUoDQRiF4WcThSBCCpuAIFiZSmSbgKBgY5MmjYWF7ZY2IlilSSeSwkvQO7FLsY2VXoQQ0qpoM4uL7E825MAwf9955wy7E83jWI3aeAnjU3xXFbfqaEhwHFpSVxzVJNzBe+jhAwehXynhJAfLDphUGaqAR4qvmIS9RsAIj2hvDAa6aaqbptleG9OmwEuclJlwhotlgdu4zyZfs1kZ9AFbywDvsFuRLtNeqK0E7uOmyP2zWBQt3wZPKXCKzhLpMnX8+0B54DlGDdJlGgUv/l7KJl7Rb5Aurzcc4jNLeF0GK/gPi9QPDC30MF4xWV5j9KJ5HD/hag1AeG5huCYYDH8BM60tncghbV0AAAAASUVORK5CYII="},1473:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABAUlEQVQ4jaXTP0oDQRTH8c9OgvcwIIgBBVu1EYuIHiOggo0X8U9hEYzHECyCjXqDKNgI3sBGAiuJFjsr45IFE78wMLx5v988Zt7L3s/XVVhBF7tYjLFX3KKP5zQ5SwwWcIojhKprZIIrnGAEzUR8g50keRMZ7pNYwAGWYoV5edNZRQyPeKipZDtWK6AdXWflEO2geLDGHAYNdAM6c4hLOgGtfxi06r4rJausreQsD4ommcZGTfwr2b81FR22PCWx7gtTBgHXGP8hucoY/YAhenMY9DAsH/EEgxnEd1HzMzQ59nCpGJg6JvHm/aj5NXU5jrGKC7zgEx94irE1RQuPStE3S7Qx3hM0lzIAAAAASUVORK5CYII="},1485:function(e,t,n){},1583:function(e,t,n){"use strict";n.r(t);n(939);var a=n(943),o=(n(813),n(815)),i=(n(192),n(101)),r=(n(382),n(103)),s=(n(810),n(812)),l=(n(193),n(77)),d=n(81),c=n(82),p=n(84),u=n(83),h=(n(1097),n(1139)),m=n(0),g=n.n(m),f=(n(102),n(75)),v=n(76),N=n(1462),C=n.n(N),k=n(1463),E=n.n(k),b=n(1464),y=n.n(b),T=n(66),I=n.n(T);function A(){var e=Object(f.a)(["\n   padding:20px;\n   height: calc(100vh - 80px);\n   background: #f6f6f3;\n  .bim-model{\n    background:#fff;\n    width:100%;\n    height:100%;\n    .model-picture {\n        height: 509px;\n        width: 100%;\n        margin:0 auto;\n        background:url(",") no-repeat center 190px ;\n        background-size:initial;\n    }\n    .model-title{\n        text-align:center;\n    }\n    .model-title p{\n        font-size:18px;color:#A0ADD0;text-align:center;padding-right:10px;\n    }\n    \n  }\n  .ant-spin-nested-loading {\n        height:100%;\n        .ant-spin-container {\n            height:100%;\n        }\n    }\n  .bim-view {\n    width:100%;\n    height:100%;\n    // background-image:url(",");\n    background-size:100%;\n    background-position:center center;\n    background-repeat: no-repeat;\n    \n    \n  }\n  .is-visble {\n      display:none;\n  }\n  .tool-bar {\n      position:absolute;bottom:40px;width:500px;margin:0 auto;height:60px;line-height:60px;text-align:center;background:url(",") 0 0 no-repeat;left:50%;transform: translate(-50%, 0%);background-size:100%;color:#fff;\n      .ant-btn-group {line-height: 72px;line-height:77px;}\n      .tool-active .icon-tool{\n        background-position-y: -300px !important;\n      }\n      .tool-btn {\n        background: transparent;border-color:transparent;margin-right:29px;height: auto;\n        .icon-tool {\n            width:29px;height:28px;background:url(",") no-repeat 0 0 ;\n        }\n        .icon-tool.icon-modal {\n            background-position:0 -271px;\n        }\n        .icon-tool.icon-filter {\n            background-position: -30px -271px;\n        }\n        .icon-tool.icon-tree {\n            background-position: -61px -271px;\n        }\n        .icon-tool.icon-ring {\n            background-position: -92px -271px;\n        }\n        .icon-tool.icon-handle {\n            background-position: -123px -271px;\n        }\n        .icon-tool.icon-floor {\n            background-position: -151px -271px;\n        }\n        \n      }\n      .ant-btn:active, .ant-btn.active{\n        background-position-y: -300px;\n      }\n      \n      .tool-btn:last-child{\n        margin-right:0;\n    }\n  }\n"]);return A=function(){return e},e}var S=v.a.div(A(),C.a,E.a,y.a,I.a),w=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).switchModel=function(){e.props.switchModels()},e}return Object(c.a)(n,[{key:"render",value:function(){return g.a.createElement("div",null,g.a.createElement("div",{className:"model-picture"}),g.a.createElement("div",{className:"model-title"},g.a.createElement("p",{style:{display:"inline-block"}},this.props.title),g.a.createElement(i.a,{type:"primary",onClick:this.switchModel},"BIM\u6a21\u578b")))}}]),n}(m.PureComponent),x=(n(385),n(261)),P=(n(892),n(917)),O=(n(391),n(266)),D=(n(1465),n(1569)),L=(n(893),n(909)),R=(n(986),n(989)),M=(n(1467),n(1568)),j=(n(383),n(194)),B=(n(392),n(14)),F=n(129),z=n.n(F),U=n(198),V=n(259),Y=n(264),K=(n(6),n(1469),n(1470),n(1471)),H=n.n(K),W=n(1472),G=n.n(W),Z=n(1473),J=n.n(Z),X=n(64);Motor.Config.serverUrl=window.MOTOR_SERVERURL_CONFIG;var q,Q,ee,te,ne,ae=h.a.TreeNode,oe="small",ie={visibleModal:!1,visibleFilter:!1,visibleTree:!1,visibleRing:!1,visibleHandel:!1,visibleFloor:!1},re={xAxis:!1,yAxis:!1,zAxis:!1,xyzAxis:!1},se=[],le=[],de={productionStateStatisticsList:"\u751f\u4ea7\u72b6\u6001",pendingProductionStatisticsList:"\u5f85\u751f\u4ea7",delayProductionStatisticsList:"\u5df2\u5ef6\u671f"},ce=[],pe={view:{showIcon:!1,showLine:!0,fontCss:{color:"#666"}},data:{simpleData:{enable:!0},key:{checked:"isChecked"}},check:{enable:!0},callback:{onCheck:function(e,t,n){Q.setVisiblityFromTree(n)},onClick:function(e,t,n){},onDblClick:function(e,t,n){},onExpand:function(e,t,n){3!==n.level||n.children||(n.children=[],function(e){return Motor.Project.getChildNodesFromTree(e)}(n).then((function(e){n.children=[],ne.addNodes(n,e),ue(ne)})))}}};function ue(e){var t=e.getNodes();t.forEach((function(e){le.push(e)}));var n=e.transformToArray(t);if(n.length>0)for(var a=0;a<n.length;a++)n[a].children||(3===n[a].level&&(n[a].isParent=!0),n[a].nocheck=!0,e.updateNode(n[a]))}function he(e,t){var n=new Image;return n.setAttribute("src",e),n}function me(e,t,n,a){var o=document.createElement("canvas"),i=o.getContext("2d");return o.width=117,o.height=74,o.title=n,o.getContext("2d").drawImage(he(e),0,0),o.getContext("2d").drawImage(he(a),10,10),i.font="12px microsoft yahei",i.fillStyle="#fff",i.maxWidth="100px",i.fillText(t,35,23),function(e){for(var t=Math.ceil(e.ctx.measureText(e.word).width/e.maxWidth),n=t>=e.maxLine?e.maxLine:t,a=0,o=0;o<n;o++){var i=e.word.slice(a),r=0;if(e.ctx.measureText(i).width>e.maxWidth){for(var s=0;s<i.length;s++)if((r+=e.ctx.measureText(i[s]).width)>e.maxWidth){o===e.maxLine-1?e.ctx.fillText(i.slice(0,s-1)+"...",e.x,e.y+18*(o+1)):e.ctx.fillText(i.slice(0,s),e.x,e.y+18*(o+1)),a+=s;break}}else e.ctx.fillText(i.slice(0),e.x,e.y+18*(o+1))}}({ctx:i,fontSize:12,word:n+"",maxWidth:100,x:10,y:30,maxLine:1}),function(e){var t=new Image;return t.src=e.toDataURL("image/png"),t.src}(o)}var ge=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={visibleModal:!1,visibleFilter:!1,visibleTree:!1,visibleRing:!1,visibleHandel:!1,visibleFloor:!1,treeValue:void 0,bimTreeData:[],autoExpandParent:!0,expandedKeys:[],checkedKeys:[],selectedKeys:[],reverse:!1,loading:!0,checkedList:["\u5df2\u5173\u8054","\u672a\u5173\u8054"],romaList:[{name:"\u9f20\u6807\u63a7\u5236\u6a21\u5f0f",id:1},{name:"\u952e\u76d8\u6a21\u5f0f",id:2}],compAttrList:[],statusAndWaring:{},filterTreeData:[],filterCheckDisable:!1,xAxis:!1,yAxis:!1,zAxis:!1,xyzAxis:!1,keyMode:!1,currentBimInfos:{projectId:"",motor3dId:""},romaValue:"1",filterPageComp:[],filterCompParams:{pageSize:1e3,ppid:0,pageIndex:1,isRefBeam:0},plainOptions:{link:!0,unlink:!0},linkComponent:{linkList:[],unlinkList:[]},markerTooltips:{name:"",position:{left:0,top:0}}},e.getDeptInfo=function(){X.r().then((function(t){1===t.data.code&&t.data.data.hasOwnProperty("deptId")&&(t.data.data.id=t.data.data.deptId,t.data.data.pId=0,t.data.data.value=t.data.data.deptId,t.data.data.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-dept"}),t.data.data.deptName),t.data.data.disabled=!0,e.getListDeptNode(t.data.data))}))},e.getListDeptNode=function(t){X.s().then((function(n){if(1===n.data.code&&n.data.data.hasOwnProperty("projectList")){var a=[],o=[];Object.keys(n.data.data).map((function(e){return n.data.data[e].map((function(e,t){e.parentId?(e.id=e.nodeId,e.pId=e.parentId,e.value=e.nodeId,e.key=e.nodeId,e.disabled=!0,1===e.nodeType?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-biao"}),e.nodeName):2===e.nodeType?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-xiang"}),e.nodeName):3===e.nodeType&&(e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-dan"}),e.nodeName))):(e.id=e.ppid,e.pId=e.nodeId,e.value=e.ppid,e.key=e.ppid,"\u571f\u5efa\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-tujian"}),e.projectName):"\u94a2\u7b4b\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-gangjin"}),e.projectName):"\u9020\u4ef7\u5de5\u7a0b"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-zaojia"}),e.projectName):"\u5b89\u88c5\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-anzhuang"}),e.projectName):"\u573a\u5e03\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-changbu"}),e.projectName):"Tekla"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-tekla"}),e.projectName):"Revit"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-revit"}),e.projectName):"\u73ed\u7b51\u5bb6\u88c5"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-banzhu"}),e.projectName):"Civil3D"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-civil3D"}),e.projectName):"Bentley"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-bentley"}),e.projectName):"Rhino"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-rhino"}),e.projectName):"IFC"===e.projTypeStr&&(e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-ifc"}),e.projectName)),0===e.nodeType||null===e.nodeType?a.push(e):o.push(e))}))}));var i=n.data.data.deptUnitList.concat(a).concat(o).concat([t]);e.setState({bimTreeData:i})}}))},e.treeNodeFilter=function(e,t){if(console.log(e,t),t.props.hasOwnProperty("projectName")){if(-1!=t.props.projectName.indexOf(e))return!0}else if(t.props.hasOwnProperty("nodeName")&&-1!=t.props.nodeName.indexOf(e))return!0;return!1},e.putBeatBim=function(e){return new Promise((function(t,n){X.T(e).then((function(e){1===e.data.code&&t(e.data)}))}))},e.handleBimSwitchOk=function(){if(void 0===e.state.treeValue)return!1;e.setState({loading:!0}),e.initBimProject(e.state.currentBimInfos)},e.getBimCompAttr=function(t){X.i(t).then((function(t){1===t.data.code&&(t.data.data.length>0?e.setState({compAttrList:t.data.data}):e.setState({compAttrList:[]}))}))},e.getPageComp=function(t){Object(Y.a)(e);return new Promise((function(e,n){X.v(t).then((function(t){e(t.data.data)}))}))},e.getStaticisticsBodyStatus=function(){var t=Object(Y.a)(e);return new Promise((function(e,n){X.J().then((function(n){e(n.data.data),1===n.data.code?t.setState({statusAndWaring:n.data.data}):t.setState({statusAndWaring:{normal:staticComponentList}})}))}))},e.showDrawer=function(t,n){e.setState(ie),e.setState({xAxis:!1,yAxis:!1,zAxis:!1,xyzAxis:!1,keyMode:!1,romaValue:e.state.romaList[0].name}),e.setState(Object(V.a)({},t,!0)),Q.deselectAllComponents(),ee.navigationMode=Motor.NavigationMode.NAV_FREE_MOUSE,q&&!q.isDestroyed()&&q.destroy(),te.removeAll(),console.log(ce,"clearComponentList"),Q.resetComponentsDefaultColorByOption(ce),"visibleModal"===t?e.getDeptInfo():"visibleRing"===t&&(ce=[],e.getStaticisticsBodyStatus().then((function(t){Object.keys(e.state.statusAndWaring).map((function(t){"productionStateStatisticsList"===t?e.state.statusAndWaring[t].map((function(e,t){var n=[];e.handles.length>0&&e.handles&&"\u672a\u751f\u4ea7"!=e.name&&(e.handles.map((function(e,t){n.push({bimGuid:e}),ce.push({bimGuid:e})})),e.componentList=n,""!=e.color&&Q.setComponentsColorByOption(n,Motor.Color.fromCssColorString(e.color)))})):"pendingProductionStatisticsList"!==t&&"delayProductionStatisticsList"!==t||e.state.statusAndWaring[t].map((function(n,a){n.handles.length>0&&n.handles&&e.markerComponent(n.handles,t,n.name)}))}))})))},e.onHandelChange=function(t,n,a){e.setState({plainOptions:{link:!0,unlink:!0}}),void 0===t?e.setState({treeValue:void 0}):a.triggerNode.props.hasOwnProperty("ppid")&&e.putBeatBim({ppid:t}).then((function(n){1===n.code&&n.data.result&&e.setState({treeValue:t,currentBimInfos:{projectId:a.triggerNode.props.projectId,motor3dId:a.triggerNode.props.motor3dId}})}))},e.onClose=function(){Q.deselectAllComponents(),e.setState(ie)},e.bimView=function(){},e.onExpand=function(t){console.log("onExpand",t),e.setState({expandedKeys:t,autoExpandParent:!1})},e.onCheck=function(t,n){n.node.props.dataRef.isChecked=n.checked,Q.setVisiblityFromTree(n.node.props.dataRef),e.siteList=n.checkedNodes,e.setState({checkedKeys:t})},e.onSelect=function(t,n){e.setState({selectedKeys:t})},e.renderTreeNodes=function(t,n){return t.map((function(t){return t.children?g.a.createElement(ae,{title:t.name,key:t.id,dataRef:t},e.renderTreeNodes(t.children,t)):g.a.createElement(ae,Object.assign({title:t.name,key:t.id},t))}))},e.filterCompFormat=function(e){var t=[];return e.map((function(e,n){e.hl&&-1===t.indexOf(e.hl)&&t.push({bimGuid:e.hl})})),t},e.filterTreeList=function(t){var n=Object(Y.a)(e);return n.state.filterCompParams.isRefBeam=t,n.state.filterCompParams.ppid=n.state.treeValue,e.setState(n.state.filterCompParams),new Promise((function(t){e.getPageComp(n.state.filterCompParams).then((function(e){return null!==e&&(0!=e.length&&void Object(U.a)(z.a.mark((function a(){var o,i;return z.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o=1,i=!1,[];case 3:if(i){a.next=9;break}return o++,a.next=7,new Promise((function(t){X.v({ppid:n.state.treeValue,pageSize:1e3,pageIndex:o,isRefBeam:n.state.filterCompParams.isRefBeam}).then((function(n){i=null!==n.data.data&&n.data.data.length<1e3,e=e.concat(n.data.data),t(e)}))}));case 7:a.next=3;break;case 9:e.length,n.setState({loading:!1}),t(e);case 11:case"end":return a.stop()}}),a)})))())}))}))},e.onCheckChange=function(t){e.setState({loading:!0});var n=Object(Y.a)(e);n.state.plainOptions.unlink="\u672a\u5173\u8054"==t.target.value?t.target.checked:n.state.plainOptions.unlink,n.state.plainOptions.link="\u5df2\u5173\u8054"==t.target.value?t.target.checked:n.state.plainOptions.link,n.state.filterCompParams.isRefBeam="\u672a\u5173\u8054"===t.target.value?0:1,n.state.filterCompParams.ppid=n.state.treeValue,n.setState(n.state.filterCompParams),n.setState(e.setState.plainOptions),console.log(e.state.loading,"loading"),0===n.state.filterCompParams.isRefBeam?setTimeout((function(){Q.setComponentsVisibilityByOption(n.filterCompFormat(n.state.linkComponent.unlinkList),t.target.checked),n.setState({loading:!1})}),1e3):setTimeout((function(){Q.setComponentsVisibilityByOption(n.filterCompFormat(n.state.linkComponent.linkList),t.target.checked),n.setState({loading:!1})}),1e3)},e.filterTreeStructure=function(t,n,a){var o=0;t.map((function(t){o++,t.pid=a,t.id=o+1+10*a,t.children&&e.filterTreeStructure(t.children,t,t.id),se.push(t.id)}))},e.handleFilterChange=function(e){},e.deepTraversa=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null!==t){n.push(t.id+"");var a=t.children;if(a)for(var o=0;o<a.length;o++)e.deepTraversa(a[o],n)}return n},e.onExpandNode=function(e){$.fn.zTree.getZTreeObj("filter-tree").expandAll(e)},e.onExpandAll=function(){var t=[];e.state.filterTreeData.forEach((function(n){t.push(e.deepTraversa(n))})),e.setState({expandedKeys:t.flat()})},e.onExpandClose=function(){console.log(e.state.autoExpandParent),e.setState({expandedKeys:[]})},e.selectComponent=function(e,t){t.stopPropagation(),Q.selectComponentsByOption(e.componentList)},e.selectMarkers=function(e){},e.deSelectComponent=function(){e.setState({compAttrList:[]}),Q.deselectAllComponents()},e.tabCallback=function(){},e.renderCompAttr=function(e,t){return e.map((function(e,t){return g.a.createElement("div",{className:"tab-property",key:e.groupName},g.a.createElement("p",{className:"tab-title"},e.attrList.filter((function(e){return""!=e.value})).length>0?e.groupName:""),e.attrList?e.attrList.map((function(e,t){return g.a.createElement("div",{className:"tab-property",key:e.name+e.id},""!==e.value?g.a.createElement("p",{className:"tab-item"},e.name,"\uff1a"+e.value):g.a.createElement(g.a.Fragment,null))})):null)}))},e.changeClippingPlaneEditor=function(t,n){var a="";q.isDestroyed()&&(q=new Motor.ClippingPlaneEditor(Q)),-1!==n.currentTarget.className.indexOf("x-axis")?a="X":-1!==n.currentTarget.className.indexOf("y-axis")?a="Y":-1!==n.currentTarget.className.indexOf("z-axis")&&(a="Z"),-1!==n.currentTarget.className.indexOf("xyz-axis")&&(a="XYZ");var o=a.toLocaleLowerCase()+"Axis",i={};i[o]=t,t?e.setState(re,(function(){e.setState(i),q.addClippingPlane(a)})):(e.setState(i),q&&!q.isDestroyed()&&q.destroy())},e.handelRomaChange=function(t){1===t?(e.setState({keyMode:!1,romaValue:t}),ee.navigationMode=Motor.NavigationMode.NAV_FREE_MOUSE):(e.setState({keyMode:!0,romaValue:t}),ee.navigationMode=Motor.NavigationMode.NAV_FREE_KEY)},e.onSliderChange=function(e){ee.roamEditor.movementSpeed=e},e.onRomaPopover=function(t){t||e.setState(ie)},e.onPopoverHide=function(t){"floor"===t.currentTarget.getAttribute("Name")?(e.setState({visibleFloor:!1}),q&&!q.isDestroyed()&&q.destroy()):(e.setState({visibleHandel:!1,keyMode:!1}),ee.navigationMode=Motor.NavigationMode.NAV_FREE_MOUSE)},e.markerComponent=function(e,t,n){var a=[],o=[];if(te.removeAll(),!e)return!1;Q.queryComponentsByBIMGuid(e).then((function(e){console.log(e,"components"),e.forEach((function(e,t){a.push(Motor.Cartographic.fromCartesian(e.position))})),a.forEach((function(e,a){o.push({id:"marker".concat(e,"-").concat(n),position:{cartographicRadians:[e.longitude,e.latitude,e.height]},pixelOffset:{cartesian2:[-10,-30]},billboard:{image:me(H.a,"pendingProductionStatisticsList"===t?"\u5f85\u751f\u4ea7":"\u5df2\u5ef6\u671f",n,"pendingProductionStatisticsList"===t?J.a:G.a),verticalOrigin:"BOTTOM",horizontalOrigin:"CENTER",sizeInMeters:!0,scale:.08,disableDepthTestDistance:Number.POSITIVE_INFINITY}})})),te.add(o)}))},e.initBimProject=function(t){if(null==t.motor3dId)return e.setState({loading:!1}),!1;ee&&(ee.isDestroyed()||ee.destroy());var n=Object(Y.a)(e);ee=new Motor.Viewer({container:e.threeViewContainer,viewerMode:Motor.ViewerMode.BIM,access_token:n.props.token,antialias:!0,backgroundColor:Motor.Color.fromCssColorString("#f6f6f3")}),Motor.Config.serverUrl=window.MOTOR_SERVERURL_CONFIG,ee.initialize().then((function(){Q=ee.queryProject(t.motor3dId),ee.enableMarquee=!0,te=new Motor.MarkerCollection({viewer:ee});var a;document.getElementById("marquee");Q.open().then((function(){q=new Motor.ClippingPlaneEditor(Q),e.markerComponent(),e.filterTreeList(0).then((function(t){e.state.linkComponent.unlinkList=t,e.setState(e.state.linkComponent),e.filterTreeList(1).then((function(a){if(e.state.linkComponent.linkList=a,e.setState(e.state.linkComponent),t.length>3e3||a.length>3e3)return l.a.error("BIM\u6a21\u578b\u8d85\u51fa3000\u4e2a\u6784\u4ef6\uff0c\u5df2\u7981\u7528\u5df2\u5173\u8054\u672a\u5173\u8054\u64cd\u4f5c\uff01"),void(n.state.filterCheckDisable=!0);n.state.filterCheckDisable=!1}))})),Q.getTreeStructure().then((function(e){e.children.length>0?n.state.filterCheckDisable=!1:(n.state.filterCheckDisable=!0,e.nocheck=!0),(ne=$.fn.zTree.init($("#filter-tree"),pe,e)).expandAll(!0),ne.checkAllNodes(!0),ue(ne)}))})),ee.addMouseEventListener(Motor.MouseEventType.MOUSE_MOVE,(function(e){n.state.markerTooltips.position.left=e.startPosition?e.startPosition.x:0,n.state.markerTooltips.position.top=e.startPosition?e.startPosition.y:0;var t=ee.pick(e.startPosition,Q);t instanceof Motor.MarkerView?-1!=t.id.indexOf("marker")&&(n.state.markerTooltips.name=t.id.split("-")[1],n.setState(n.state.markerTooltips)):(n.state.markerTooltips.name="",n.setState(n.state.markerTooltips))})),ee.addMouseEventListener(Motor.MouseEventType.LEFT_CLICK,(function(e){console.log(e,"mouse"),Q.deselectAllComponents();var t=ee.pick(e.position,Q);t instanceof Motor.Component?(console.log(t,"infos"),t.select(),a=t,t.getProperties().then((function(e){n.getBimCompAttr({handle:e.bimGuid,ppid:parseInt(n.state.treeValue),projTypeStr:n.props.treeNode.projTypeStr,floor:e.floor})}))):a&&a.deselect()})),ee.addMouseEventListener(Motor.MouseEventType.LEFT_DOUBLE_CLICK,(function(e){var t=ee.pick(e.position,Q);t instanceof Motor.Component&&ee.flyTo(t)}))}))},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this.state.treeValue?this.state.currentBimInfos:this.props.selectBimInfo;this.setState({treeValue:this.props.treeNode.ppid}),this.initBimProject(e)}},{key:"render",value:function(){var e=this,t={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return g.a.createElement(g.a.Fragment,null,g.a.createElement(x.a,{spinning:this.state.loading,tip:"\u62fc\u547d\u52a0\u8f7d\u4e2d..."},g.a.createElement("img",{src:H.a,alt:"bg",style:{display:"none"},id:"ringoImage"}),g.a.createElement("img",{src:G.a,alt:"icon",style:{display:"none"},id:"icon"}),g.a.createElement("img",{src:J.a,alt:"iconWarning",style:{display:"none"},id:"iconWarning"}),""!=this.state.markerTooltips.name?g.a.createElement("div",{className:"tootips",style:{left:this.state.markerTooltips.position.left,top:this.state.markerTooltips.position.top}},this.state.markerTooltips.name):g.a.createElement(g.a.Fragment,null),g.a.createElement(s.a,{className:"bim-view",onClick:function(){return e.bimView()}},g.a.createElement("div",{ref:function(t){return e.threeViewContainer=t},style:{height:"100%"}})),g.a.createElement(s.a,{className:"tool-bar ".concat(null==this.props.selectBimInfo.motor3dId?"is-visble":"")},g.a.createElement(i.a.Group,null,g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleModal?"tool-active":""),title:"BIM\u6a21\u578b",onClick:function(){return e.showDrawer("visibleModal")}},g.a.createElement("span",{className:"icon-tool icon-modal"})),g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleFilter?"tool-active":""),title:"\u7b5b\u9009",onClick:function(){return e.showDrawer("visibleFilter")}},g.a.createElement("span",{className:"icon-tool icon-filter"})),g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleTree?"tool-active":""),title:"\u6784\u4ef6\u5c5e\u6027",onClick:function(){return e.showDrawer("visibleTree")}},g.a.createElement("span",{className:"icon-tool icon-tree"})),g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleRing?"tool-active":""),title:"\u72b6\u6001\u53ca\u9884\u8b66",onClick:function(){return e.showDrawer("visibleRing")}},g.a.createElement("span",{className:"icon-tool icon-ring"})),g.a.createElement(R.a,{placement:"top",title:g.a.createElement("p",null,"\u6f2b\u6e38",g.a.createElement("span",{style:{float:"right"},name:"roma",onClick:this.onPopoverHide},g.a.createElement(B.a,{type:"close"}))),overlayClassName:"popover-roma",arrowPointAtCenter:!0,autoAdjustOverflow:!0,visible:this.state.visibleHandel,onVisibleChange:this.onPopoverChange,content:g.a.createElement("div",{onClick:this.hide},g.a.createElement("span",{className:"icon-schema"}),g.a.createElement(j.a,{value:this.state.romaValue,style:{width:200},onChange:this.handelRomaChange},this.state.romaList.map((function(e,t){return g.a.createElement(j.a.Option,{value:e.id,key:t},e.name)}))),g.a.createElement("p",{style:{paddingTop:"10px"}},g.a.createElement("span",{className:"icon-speed"}),"\u79fb\u52a8\u901f\u5ea6"),g.a.createElement(M.a,{min:0,max:10,step:1,defaultValue:1,disabled:!this.state.keyMode,onAfterChange:this.onSliderChange})),trigger:"click"},g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleHandel?"tool-active":""),title:"\u6f2b\u6e38",onClick:function(){return e.showDrawer("visibleHandel")}},g.a.createElement("span",{className:"icon-tool icon-handle"}))),g.a.createElement(R.a,{placement:"top",visible:this.state.visibleFloor,title:g.a.createElement("p",null,"\u5256\u5207",g.a.createElement("span",{name:"floor",style:{float:"right"},onClick:this.onPopoverHide},g.a.createElement(B.a,{type:"close"}))),overlayClassName:"popover-roma",arrowPointAtCenter:!0,autoAdjustOverflow:!0,onVisibleChange:this.onPopoverChange,content:g.a.createElement("div",null,g.a.createElement("div",null,g.a.createElement("span",{className:"x-span"},"X\u8f74\uff1a"),g.a.createElement(L.a,{size:"small",className:"x-axis",checkedChildren:"\u5f00",unCheckedChildren:"\u5173",checked:this.state.xAxis,onChange:this.changeClippingPlaneEditor})),g.a.createElement("div",null,g.a.createElement("span",{className:"x-span"},"Y\u8f74\uff1a"),g.a.createElement(L.a,{size:"small",className:"y-axis",checkedChildren:"\u5f00",unCheckedChildren:"\u5173",checked:this.state.yAxis,onChange:this.changeClippingPlaneEditor})),g.a.createElement("div",null,g.a.createElement("span",{className:"x-span"},"Z\u8f74\uff1a"),g.a.createElement(L.a,{size:"small",className:"z-axis",checkedChildren:"\u5f00",unCheckedChildren:"\u5173",checked:this.state.zAxis,onChange:this.changeClippingPlaneEditor})),g.a.createElement("div",null,g.a.createElement("span",{className:"x-span"},"XYZ\u8f74\uff1a"),g.a.createElement(L.a,{size:"small",className:"xyz-axis",checkedChildren:"\u5f00",unCheckedChildren:"\u5173",checked:this.state.xyzAxis,onChange:this.changeClippingPlaneEditor}))),trigger:"click"},g.a.createElement(i.a,{size:oe,className:"tool-btn ".concat(this.state.visibleFloor?"tool-active":""),title:"\u5256\u5207",onClick:function(){return e.showDrawer("visibleFloor")}},g.a.createElement("span",{className:"icon-tool icon-floor"})))),g.a.createElement(D.a,{className:"drawer-view",title:"BIM\u6a21\u578b",placement:"right",closable:!0,mask:!1,width:339,height:200,onClose:this.onClose,visible:this.state.visibleModal},g.a.createElement(r.a,t,g.a.createElement(r.a.Item,{label:"\u6881\u573aBIM\u6a21\u578b",className:"form-item"},g.a.createElement(h.a,{showSearch:!0,treeDataSimpleMode:!0,dropdownClassName:"bim-drawer-tree",value:this.state.treeValue,dropdownStyle:{minWidth:300,maxWidth:300,maxHeight:400,overflow:"auto"},placeholder:"\u5173\u8054\u6a21\u578b",filterTreeNode:this.treeNodeFilter,allowClear:!0,treeDefaultExpandAll:!0,getPopupContainer:function(e){return e.parentNode},treeData:this.state.bimTreeData,onChange:this.onHandelChange})),g.a.createElement(r.a.Item,{className:"form-item"},g.a.createElement(a.a,{showLine:!0,checkable:!0,onExpand:this.onExpand,onCheck:this.onCheck,checkedKeys:this.state.checkedKeys,onSelect:this.onSelect,selectedKeys:this.state.selectedKeys,defaultExpandAll:!0,switcherIcon:g.a.createElement("span",{className:"icon-arrow"})},this.renderTreeNodes(this.state.filterTreeData)))),g.a.createElement("div",{style:{position:"absolute",bottom:"20px"}},g.a.createElement(i.a,{style:{marginLeft:"48px",marginRight:"20px"},onClick:this.onClose},"\u53d6\u6d88"),g.a.createElement(i.a,{type:"primary",onClick:function(){return e.handleBimSwitchOk()}},"\u786e\u5b9a"))),g.a.createElement(D.a,Object(V.a)({className:"drawer-view",title:"\u7b5b\u9009",placement:"right",closable:!0,mask:!1,width:339,onClose:this.onClose,visible:!0},"className",this.state.visibleFilter?"filter-show":"filter-hide"),g.a.createElement("div",{style:{marginBottom:"13px"}},g.a.createElement(O.a,{value:"\u5df2\u5173\u8054",disabled:this.state.filterCheckDisable,checked:this.state.plainOptions.link,onChange:this.onCheckChange},"\u5df2\u5173\u8054"),g.a.createElement(O.a,{value:"\u672a\u5173\u8054",disabled:this.state.filterCheckDisable,checked:this.state.plainOptions.unlink,onChange:this.onCheckChange},"\u672a\u5173\u8054"),g.a.createElement("div",{style:{float:"right"}},g.a.createElement("span",{className:"expandAll",onClick:function(){return e.onExpandNode(!0)}},g.a.createElement(B.a,{type:"plus"})),g.a.createElement("span",{className:"closeAll",onClick:function(){return e.onExpandNode(!1)}},g.a.createElement(B.a,{type:"line"})))),g.a.createElement("ul",{id:"filter-tree",className:"ztree"})),g.a.createElement(D.a,{className:"drawer-view drawer-tab",placement:"right",closable:!0,mask:!1,width:339,onClose:this.onClose,visible:this.state.visibleTree},g.a.createElement(P.a,{defaultActiveKey:"1",onChange:function(){return e.tabCallback}},g.a.createElement(P.a.TabPane,{tab:"\u5c5e\u6027",key:"1"},this.state.compAttrList.length>0?this.renderCompAttr(this.state.compAttrList):g.a.createElement("p",{className:"no-comp"},"\u672a\u9009\u62e9\u6784\u4ef6\uff0c\u6682\u65e0\u6570\u636e")))),g.a.createElement(D.a,{className:"drawer-visibleRing",title:"\u9884\u8b66",placement:"right",closable:!0,mask:!1,width:339,onClose:this.onClose,visible:this.state.visibleRing,onClick:function(){return e.deSelectComponent()}},Object.keys(this.state.statusAndWaring).map((function(t){return g.a.createElement("div",{className:"tab-ring",key:t},e.state.statusAndWaring[t].length>0?g.a.createElement("p",{className:"tab-title"},de[t]):null,"productionStateStatisticsList"===t?e.state.statusAndWaring[t].map((function(t,n){return t.number>0?g.a.createElement("div",{className:"tab-item",key:n},g.a.createElement("span",{className:"ring-legend ".concat("\u672a\u751f\u4ea7"===t.name?"no-prodect":null),style:{background:"".concat(t.color)}},"\u672a\u751f\u4ea7"===t.name?g.a.createElement("span",{className:"line"}):null),g.a.createElement("p",null,t.name),t.handles?g.a.createElement("span",{onClick:function(n){return e.selectComponent(t,n)}},t.number):g.a.createElement("span",{style:{color:"#ccc"}},t.number)):null})):e.state.statusAndWaring[t].map((function(n,a){return n.number>0?g.a.createElement("div",{className:"tab-item",key:a,onClick:function(){return e.selectMarkers(n)}},g.a.createElement("span",{className:"ring-image ".concat("pendingProductionStatisticsList"===t?"ring-produced-img":"ring-postpone-img")}),g.a.createElement("p",null,n.status?"\u672a\u5230\u8fbe\uff1a":"\u5df2\u5230\u8fbe\uff1a",n.name),g.a.createElement("span",null,n.number)):null})))}))))))}}]),n}(m.Component),fe=(n(1485),h.a.TreeNode),ve="",Ne=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={bimVisible:!1,treeValue:void 0,init3dView:!1,siteSwitchVisible:!1,checkedKeys:[],selectedKeys:[],siteList:[],bimTreeData:[],selectBimProject:"",selectBimInfo:{projectId:"",motor3dId:""},currentTreeNode:{}},e.getDeptInfo=function(){X.r().then((function(t){1===t.data.code&&t.data.data.hasOwnProperty("deptId")&&(t.data.data.id=t.data.data.deptId,t.data.data.pId=0,t.data.data.value=t.data.data.deptId,t.data.data.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-dept"}),t.data.data.deptName),t.data.data.disabled=!0,t.data.data.key=t.data.data.deptId,e.getListDeptNode(t.data.data))}))},e.getListDeptNode=function(t){X.s().then((function(n){if(1===n.data.code&&n.data.data.hasOwnProperty("projectList")){var a=[],o=[];Object.keys(n.data.data).map((function(e){return n.data.data[e].map((function(e,t){e.parentId?(e.id=e.nodeId,e.pId=e.parentId,e.disabled=!0,e.value=e.nodeId,e.key=e.nodeId,1===e.nodeType?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-biao"}),e.nodeName):2===e.nodeType?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-xiang"}),e.nodeName):3===e.nodeType&&(e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-dan"}),e.nodeName))):(e.id=e.ppid,e.pId=e.nodeId,e.value=e.ppid,e.key=e.ppid,"\u571f\u5efa\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-tujian"}),e.projectName):"\u94a2\u7b4b\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-gangjin"}),e.projectName):"\u9020\u4ef7\u5de5\u7a0b"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-zaojia"}),e.projectName):"\u5b89\u88c5\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-anzhuang"}),e.projectName):"\u573a\u5e03\u9884\u7b97"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-changbu"}),e.projectName):"Tekla"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-tekla"}),e.projectName):"Revit"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-revit"}),e.projectName):"\u73ed\u7b51\u5bb6\u88c5"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-banzhu"}),e.projectName):"Civil3D"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-civil3D"}),e.projectName):"Bentley"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-bentley"}),e.projectName):"Rhino"===e.projTypeStr?e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-rhino"}),e.projectName):"IFC"===e.projTypeStr&&(e.title=g.a.createElement("span",null,g.a.createElement("span",{className:"icon-project icon-ifc"}),e.projectName)),0===e.nodeType||null===e.nodeType?a.push(e):o.push(e))}))}));var i=n.data.data.deptUnitList.concat(a).concat(o).concat([t]);e.setState({bimTreeData:i})}}))},e.treeNodeFilter=function(e,t){if(console.log(e,t),t.props.hasOwnProperty("projectName")){if(-1!=t.props.projectName.indexOf(e))return!0}else if(t.props.hasOwnProperty("nodeName")&&-1!=t.props.nodeName.indexOf(e))return!0;return!1},e.putBeatBim=function(e){return new Promise((function(t,n){X.T(e).then((function(e){1===e.data.code&&t(e.data)}))}))},e.getMotorToken=function(){X.t().then((function(e){1==e.data.code&&(ve=e.data.data.token)}))},e.switchModels=function(){e.getDeptInfo(),e.setState({bimSwitchVisible:!0})},e.onHandelChange=function(t,n,a){void 0===t?e.setState({treeValue:void 0}):a.triggerNode.props.hasOwnProperty("ppid")&&e.putBeatBim({ppid:t}).then((function(n){1===n.code&&n.data.result?e.setState({selectBimProject:t,currentTreeNode:a.triggerNode.props,treeValue:t,selectBimInfo:{projectId:a.triggerNode.props.projectId,motor3dId:a.triggerNode.props.motor3dId}}):l.a.error(n.msg)}))},e.handleBimSwitchOk=function(){if(void 0===e.state.treeValue||null===e.state.selectBimInfo.motor3dId)return null===e.state.selectBimInfo.motor3dId&&l.a.error("\u5de5\u7a0b\u6ca1\u6709\u7ed1\u5b9a\u6a21\u578b\uff01"),!1;e.setState({bimSwitchVisible:!1,init3dView:!0,treeValue:void 0})},e.handleBimSwitchCancel=function(){e.setState({bimSwitchVisible:!1,treeValue:void 0})},e.switchSiteModal=function(){e.setState({siteSwitchVisible:!0})},e.onExpand=function(t){console.log("onExpand",t),e.setState({expandedKeys:t,autoExpandParent:!1})},e.onCheck=function(t,n){e.siteList=n.checkedNodes,e.setState({checkedKeys:t})},e.onSelect=function(t,n){e.setState({selectedKeys:t})},e.renderTreeNodes=function(t){return t.map((function(t){return t.children?g.a.createElement(fe,{value:t.title,title:t.title,key:t.key,dataRef:t},e.renderTreeNodes(t.children)):g.a.createElement(fe,Object.assign({key:t.key},t))}))},e.handleSiteSwitchOk=function(){e.siteList;e.setState({siteList:e.siteList,siteSwitchVisible:!1},(function(){}))},e.renderSiteItem=function(t){return t.map((function(t,n){return g.a.createElement("p",{key:n},t.props.title,g.a.createElement("span",{className:"icon-delete",onClick:function(){return e.removeSiteItem(t,n)}}))}))},e.removeSiteItem=function(t,n){var a=e.state.siteList,o=_.cloneDeep(a);o.splice(n,1),e.setState({siteList:o})},e.handleSiteSwitchCancel=function(){e.setState({siteSwitchVisible:!1})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.getMotorToken()}},{key:"render",value:function(){return g.a.createElement(S,null,this.state.init3dView?g.a.createElement(ge,{bimProject:this.state.selectBimProject,selectBimInfo:this.state.selectBimInfo,treeNode:this.state.currentTreeNode,token:ve}):g.a.createElement(s.a,{className:"bim-model"},g.a.createElement(w,{title:"\u6682\u65e0BIM\u6a21\u578b\uff0c\u8bf7\u9009\u62e9\u6881\u573a\u9700\u5173\u8054\u7684",switchModels:this.switchModels})),g.a.createElement(o.a,{className:"select-modal",title:"BiM\u6a21\u578b",maskClosable:!1,visible:this.state.bimSwitchVisible,onOk:this.handleBimSwitchOk,onCancel:this.handleBimSwitchCancel},g.a.createElement(r.a,Object.assign({},{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},{onSubmit:this.handleBimSwitchOk}),g.a.createElement(r.a.Item,{label:"\u6881\u573aBIM\u6a21\u578b",className:"form-item"},g.a.createElement(h.a,{treeDataSimpleMode:!0,showSearch:!0,style:{width:"100%"},value:this.state.treeValue,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"\u5173\u8054\u6a21\u578b",allowClear:!0,treeDefaultExpandAll:!0,filterTreeNode:this.treeNodeFilter,dropdownClassName:"bim-tree",treeData:this.state.bimTreeData,onChange:this.onHandelChange})),g.a.createElement(r.a.Item,{label:"\u6865\u6881BIM\u6a21\u578b",className:"form-item"},g.a.createElement(i.a,{className:"bim-btn-default",disabled:!0,onClick:this.switchSiteModal},"\u9009\u62e9\u6a21\u578b")),g.a.createElement(r.a.Item,null,this.state.siteList.length>0?g.a.createElement("div",{className:"site-item"},this.renderSiteItem(this.state.siteList)):""))),g.a.createElement(o.a,{className:"site-modal",title:"\u9009\u62e9\u6a21\u578b",visible:this.state.siteSwitchVisible,onOk:this.handleSiteSwitchOk,onCancel:this.handleSiteSwitchCancel},g.a.createElement(a.a,{checkable:!0,onExpand:this.onExpand,onCheck:this.onCheck,checkedKeys:this.state.checkedKeys,onSelect:this.onSelect,selectedKeys:this.state.selectedKeys,defaultExpandAll:!0},this.renderTreeNodes(this.state.bimTreeData))))}}]),n}(m.PureComponent);t.default=Ne}}]);
//# sourceMappingURL=20.edac6362.chunk.js.map